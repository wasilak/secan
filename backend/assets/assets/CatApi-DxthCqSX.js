import{e as Q,R as J,r as i,k as D,j as e,A as b,I as y,G as o,l as F,m as u,N as U,S as I,ak as W,a6 as M,$ as N,a0 as X,_ as L,n as l,K as O,o as v}from"./index-BieC20NY.js";import{u as Y}from"./useMutation-z0A9RI5n.js";import{C as _}from"./Container-DThP4-yo.js";import{B as A}from"./Button-220SnSZb.js";import{C as z}from"./Card-CmduAh09.js";import{A as g}from"./Accordion-j_lhrryX.js";import{B}from"./Badge-BFQ8acFD.js";import{T as Z}from"./TextInput-5DgMqmJI.js";import{I as ee,a as se}from"./IconSortDescending-QW95ub-2.js";import"./get-safe-id-Bp3H8K0-.js";var te=Q("help","IconHelp",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 17l0 .01",key:"svg-1"}],["path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4",key:"svg-2"}]]);const ae={aliases:"Show alias information",allocation:"Show shard allocation across nodes",count:"Show document counts",fielddata:"Show fielddata memory usage",health:"Show cluster health",indices:"Show index information",master:"Show master node",nodeattrs:"Show node attributes",nodes:"Show node information",pending_tasks:"Show pending cluster tasks",plugins:"Show installed plugins",recovery:"Show index recovery information",repositories:"Show snapshot repositories",segments:"Show segment information",shards:"Show shard information",snapshots:"Show snapshots",tasks:"Show running tasks",templates:"Show index templates",thread_pool:"Show thread pool statistics"};function xe(){const{id:r}=J(),[a,T]=i.useState(""),[c,k]=i.useState(""),[d,E]=i.useState(null),[p,f]=i.useState("asc"),[m,S]=i.useState(!1),{data:w}=D({queryKey:["cluster",r,"cat-endpoints"],queryFn:()=>v.getCatEndpoints(r),enabled:!!r}),t=Y({mutationFn:s=>v.executeCatApi(r,s),onError:s=>{O.show({title:"Error",message:`Failed to execute Cat API: ${s.message}`,color:"red"})}}),{data:P}=D({queryKey:["cluster",r,"cat-help",a],queryFn:()=>v.getCatApiHelp(r,a),enabled:!!r&&!!a&&m}),$=()=>{if(!a){O.show({title:"Error",message:"Please select a Cat API endpoint",color:"red"});return}t.mutate(a)},K=()=>{T(""),k(""),E(null),f("asc"),S(!1),t.reset()},G=()=>{S(!m)},V=s=>{d===s?f(p==="asc"?"desc":"asc"):(E(s),f("asc"))},H=i.useMemo(()=>!t.data||t.data.length===0?[]:Object.keys(t.data[0]),[t.data]),C=i.useMemo(()=>{if(!t.data)return[];let s=[...t.data];if(c.trim()){const x=c.toLowerCase();s=s.filter(n=>Object.values(n).some(h=>String(h).toLowerCase().includes(x)))}return d&&s.sort((x,n)=>{const h=x[d],j=n[d];if(typeof h=="number"&&typeof j=="number")return p==="asc"?h-j:j-h;const R=String(h).toLowerCase(),q=String(j).toLowerCase();return p==="asc"?R.localeCompare(q):q.localeCompare(R)}),s},[t.data,c,d,p]);return r?e.jsxs(_,{size:"xl",py:"md",children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsxs("div",{children:[e.jsx(F,{order:2,children:"Cat API"}),e.jsx(u,{size:"sm",c:"dimmed",children:"Access Elasticsearch Cat APIs for compact, human-readable cluster information"})]}),e.jsx(A,{leftSection:e.jsx(U,{size:16}),variant:"light",onClick:K,children:"Reset"})]}),e.jsxs(I,{gap:"md",children:[e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(I,{gap:"md",children:[e.jsx(W,{label:"Cat API Endpoint",placeholder:"Select an endpoint",value:a,onChange:s=>{T(s||""),t.reset(),S(!1)},data:(w==null?void 0:w.map(s=>({value:s,label:`${s} - ${ae[s]||"No description"}`})))||[],searchable:!0,required:!0}),e.jsxs(o,{justify:"space-between",children:[e.jsx(A,{leftSection:e.jsx(te,{size:16}),variant:"light",onClick:G,disabled:!a,children:m?"Hide Help":"Show Help"}),e.jsx(A,{leftSection:e.jsx(M,{size:16}),onClick:$,loading:t.isPending,disabled:!a,children:"Execute"})]}),m&&a&&e.jsx(g,{variant:"contained",children:e.jsxs(g.Item,{value:"help",children:[e.jsx(g.Control,{children:e.jsxs(u,{size:"sm",fw:500,children:["Help for ",a]})}),e.jsx(g.Panel,{children:P?e.jsx(N,{h:200,children:e.jsx(X,{block:!0,children:P})}):e.jsxs(o,{justify:"center",children:[e.jsx(L,{size:"sm"}),e.jsx(u,{size:"sm",children:"Loading help text..."})]})})]})})]})}),t.data&&t.data.length>0&&e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(I,{gap:"md",children:[e.jsxs(o,{justify:"space-between",children:[e.jsxs(o,{children:[e.jsx(F,{order:3,children:"Results"}),e.jsxs(B,{size:"lg",variant:"light",children:[C.length," rows"]})]}),e.jsx(Z,{placeholder:"Filter results...",value:c,onChange:s=>k(s.currentTarget.value),w:300,leftSection:e.jsx(M,{size:16})})]}),e.jsx(N,{children:e.jsxs(l,{striped:!0,highlightOnHover:!0,children:[e.jsx(l.Thead,{children:e.jsx(l.Tr,{children:H.map(s=>e.jsx(l.Th,{onClick:()=>V(s),style:{cursor:"pointer",userSelect:"none"},children:e.jsxs(o,{gap:"xs",children:[e.jsx(u,{size:"sm",fw:500,children:s}),d===s&&(p==="asc"?e.jsx(ee,{size:14}):e.jsx(se,{size:14}))]})},s))})}),e.jsx(l.Tbody,{children:C.map((s,x)=>e.jsx(l.Tr,{children:H.map(n=>e.jsx(l.Td,{children:typeof s[n]=="number"?e.jsx(B,{variant:"light",children:s[n]}):e.jsx(u,{size:"sm",children:String(s[n])})},n))},x))})]})}),C.length===0&&c&&e.jsxs(b,{icon:e.jsx(y,{size:16}),color:"blue",variant:"light",children:['No results match the filter "',c,'"']})]})}),t.data&&t.data.length===0&&e.jsx(b,{icon:e.jsx(y,{size:16}),color:"blue",variant:"light",children:"No data returned from the Cat API endpoint"}),t.isPending&&e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(o,{justify:"center",children:[e.jsx(L,{size:"lg"}),e.jsx(u,{children:"Executing Cat API request..."})]})})]})]}):e.jsx(_,{size:"xl",children:e.jsx(b,{icon:e.jsx(y,{size:16}),title:"Error",color:"red",children:"Cluster ID is required"})})}export{xe as CatApiPage};
