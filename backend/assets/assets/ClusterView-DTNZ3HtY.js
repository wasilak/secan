import{c as B,r as $,f as de,g as X,n as t,e as p,j as e,M as m,A as _,h as oe,i as Y,S as u,b as a,G as T,k as Q,a as U,L as R,T as te,u as ee,l as se,m as G,d as i,o as Z,p as ce,q as he}from"./index-DcfaDkqY.js";import{u as me}from"./usePreferences-FkX0YgZk.js";import{u as I}from"./useMutation-zlYX3-He.js";import{u as ue}from"./accessibility-Bub0VNYu.js";import{T as xe}from"./Tooltip-DbgTiafr.js";import{I as je}from"./IconRefresh-ZyObQHjv.js";import{I as ge}from"./IconDeviceFloppy-DY4lh6aj.js";import{I as fe}from"./IconTrash-DKJe54X6.js";import{T as H}from"./TextInput-BOaVIyxq.js";import{B as F}from"./Button-Bkll3Rdy.js";import{N as pe}from"./NumberInput-CFy2BDRV.js";import{C as q}from"./Container-DMlcQyHq.js";import{A as E,I as N}from"./IconAlertCircle-Dcc7bj5k.js";import{B as D}from"./Badge-DJNXSXN5.js";import{G as C}from"./Grid-DHd_wTAd.js";import{C as z}from"./Card-shqYZ03S.js";import{P as A}from"./Progress-CWs8DOSL.js";import{T as y}from"./Tabs-n-E2t0TM.js";import"./InputBase-DyPrwlhe.js";import"./get-auto-contrast-value-Da6zqqWm.js";import"./get-safe-id-Bp3H8K0-.js";var re=B("dots","IconDots",[["path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]),Te=B("eraser","IconEraser",[["path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3",key:"svg-0"}],["path",{d:"M18 13.3l-6.3 -6.3",key:"svg-1"}]]),ye=B("folder-off","IconFolderOff",[["path",{d:"M8 4h1l3 3h7a2 2 0 0 1 2 2v8m-2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 1.189 -1.829",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]),Ce=B("folder-open","IconFolderOpen",[["path",{d:"M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2",key:"svg-0"}]]);function ne(n,r=300){const[c,o]=$.useState(n);return $.useEffect(()=>{const s=setTimeout(()=>{o(n)},r);return()=>{clearTimeout(s)}},[n,r]),c}function ve({clusterId:n,index:r}){const c=de(),{announceSuccess:o,announceError:s}=ue(),[h,{open:f,close:g}]=X(!1),[x,{open:l,close:j}]=X(!1),[L,M]=$.useState(""),[b,w]=$.useState(1),P=I({mutationFn:()=>p.openIndex(n,r.name),onMutate:()=>{t.show({id:`open-${r.name}`,title:"Opening index",message:`Opening index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`open-${r.name}`,title:"Success",message:`Index ${r.name} opened successfully`,color:"green",loading:!1,autoClose:3e3}),o(`Index ${r.name} opened successfully`),c.invalidateQueries({queryKey:["cluster",n,"indices"]})},onError:d=>{t.update({id:`open-${r.name}`,title:"Error",message:`Failed to open index: ${d.message}`,color:"red",loading:!1,autoClose:5e3}),s(`Failed to open index: ${d.message}`)}}),O=I({mutationFn:()=>p.closeIndex(n,r.name),onMutate:()=>{t.show({id:`close-${r.name}`,title:"Closing index",message:`Closing index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`close-${r.name}`,title:"Success",message:`Index ${r.name} closed successfully`,color:"green",loading:!1,autoClose:3e3}),c.invalidateQueries({queryKey:["cluster",n,"indices"]})},onError:d=>{t.update({id:`close-${r.name}`,title:"Error",message:`Failed to close index: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),k=I({mutationFn:()=>p.deleteIndex(n,r.name),onMutate:()=>{t.show({id:`delete-${r.name}`,title:"Deleting index",message:`Deleting index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`delete-${r.name}`,title:"Success",message:`Index ${r.name} deleted successfully`,color:"green",loading:!1,autoClose:3e3}),c.invalidateQueries({queryKey:["cluster",n,"indices"]}),g(),M("")},onError:d=>{t.update({id:`delete-${r.name}`,title:"Error",message:`Failed to delete index: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),K=I({mutationFn:d=>p.forceMergeIndex(n,r.name,d),onMutate:()=>{t.show({id:`forcemerge-${r.name}`,title:"Force merging index",message:`Force merging index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`forcemerge-${r.name}`,title:"Success",message:`Index ${r.name} force merged successfully`,color:"green",loading:!1,autoClose:3e3}),j(),w(1)},onError:d=>{t.update({id:`forcemerge-${r.name}`,title:"Error",message:`Failed to force merge index: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),W=I({mutationFn:()=>p.clearCacheIndex(n,r.name),onMutate:()=>{t.show({id:`clearcache-${r.name}`,title:"Clearing cache",message:`Clearing cache for index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`clearcache-${r.name}`,title:"Success",message:`Cache cleared for index ${r.name}`,color:"green",loading:!1,autoClose:3e3})},onError:d=>{t.update({id:`clearcache-${r.name}`,title:"Error",message:`Failed to clear cache: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),V=I({mutationFn:()=>p.refreshIndex(n,r.name),onMutate:()=>{t.show({id:`refresh-${r.name}`,title:"Refreshing index",message:`Refreshing index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`refresh-${r.name}`,title:"Success",message:`Index ${r.name} refreshed successfully`,color:"green",loading:!1,autoClose:3e3})},onError:d=>{t.update({id:`refresh-${r.name}`,title:"Error",message:`Failed to refresh index: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),J=I({mutationFn:()=>p.flushIndex(n,r.name),onMutate:()=>{t.show({id:`flush-${r.name}`,title:"Flushing index",message:`Flushing index ${r.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{t.update({id:`flush-${r.name}`,title:"Success",message:`Index ${r.name} flushed successfully`,color:"green",loading:!1,autoClose:3e3})},onError:d=>{t.update({id:`flush-${r.name}`,title:"Error",message:`Failed to flush index: ${d.message}`,color:"red",loading:!1,autoClose:5e3})}}),le=()=>{L===r.name&&k.mutate()},ae=()=>{const d=typeof b=="number"?b:parseInt(b,10);!isNaN(d)&&d>0&&K.mutate(d)};return e.jsxs(e.Fragment,{children:[e.jsxs(m,{shadow:"md",width:200,children:[e.jsx(m.Target,{children:e.jsx(xe,{label:"Index operations",children:e.jsx(_,{variant:"subtle",color:"gray","aria-label":`Operations for index ${r.name}`,children:e.jsx(re,{size:16,"aria-hidden":"true"})})})}),e.jsxs(m.Dropdown,{children:[e.jsx(m.Label,{children:"Index Operations"}),r.status==="close"?e.jsx(m.Item,{leftSection:e.jsx(Ce,{size:14,"aria-hidden":"true"}),onClick:()=>P.mutate(),disabled:P.isPending,children:"Open Index"}):e.jsx(m.Item,{leftSection:e.jsx(ye,{size:14,"aria-hidden":"true"}),onClick:()=>O.mutate(),disabled:O.isPending,children:"Close Index"}),e.jsx(m.Item,{leftSection:e.jsx(je,{size:14,"aria-hidden":"true"}),onClick:()=>V.mutate(),disabled:V.isPending,children:"Refresh"}),e.jsx(m.Item,{leftSection:e.jsx(ge,{size:14,"aria-hidden":"true"}),onClick:()=>J.mutate(),disabled:J.isPending,children:"Flush"}),e.jsx(m.Item,{leftSection:e.jsx(Te,{size:14,"aria-hidden":"true"}),onClick:()=>W.mutate(),disabled:W.isPending,children:"Clear Cache"}),e.jsx(m.Item,{leftSection:e.jsx(oe,{size:14,"aria-hidden":"true"}),onClick:l,children:"Force Merge"}),e.jsx(m.Divider,{}),e.jsx(m.Item,{leftSection:e.jsx(fe,{size:14,"aria-hidden":"true"}),color:"red",onClick:f,children:"Delete Index"})]})]}),e.jsx(Y,{opened:h,onClose:()=>{g(),M("")},title:"Delete Index",centered:!0,"aria-labelledby":"delete-modal-title","aria-describedby":"delete-modal-description",children:e.jsxs(u,{gap:"md",children:[e.jsxs(a,{size:"sm",id:"delete-modal-description",children:["Are you sure you want to delete index ",e.jsx(a,{span:!0,fw:700,children:r.name}),"? This action cannot be undone."]}),e.jsx(a,{size:"sm",c:"dimmed",children:"Type the index name to confirm:"}),e.jsx(H,{placeholder:r.name,value:L,onChange:d=>M(d.currentTarget.value),"data-autofocus":!0,"aria-label":"Confirm index name","aria-required":"true"}),e.jsxs(T,{justify:"flex-end",children:[e.jsx(F,{variant:"default",onClick:()=>{g(),M("")},children:"Cancel"}),e.jsx(F,{color:"red",onClick:le,disabled:L!==r.name||k.isPending,loading:k.isPending,"aria-label":`Delete index ${r.name}`,children:"Delete"})]})]})}),e.jsx(Y,{opened:x,onClose:()=>{j(),w(1)},title:"Force Merge Index",centered:!0,"aria-labelledby":"forcemerge-modal-title","aria-describedby":"forcemerge-modal-description",children:e.jsxs(u,{gap:"md",children:[e.jsxs(a,{size:"sm",id:"forcemerge-modal-description",children:["Force merge index ",e.jsx(a,{span:!0,fw:700,children:r.name})," to reduce the number of segments."]}),e.jsx(pe,{label:"Maximum number of segments",description:"The number of segments to merge to. Set to 1 for a single segment.",placeholder:"1",value:b,onChange:w,min:1,max:100,"aria-label":"Maximum number of segments","aria-required":"true"}),e.jsxs(T,{justify:"flex-end",children:[e.jsx(F,{variant:"default",onClick:()=>{j(),w(1)},children:"Cancel"}),e.jsx(F,{onClick:ae,disabled:K.isPending,loading:K.isPending,"aria-label":`Force merge index ${r.name}`,children:"Force Merge"})]})]})})]})}function ie(n){switch(n){case"green":return"green";case"yellow":return"yellow";case"red":return"red";default:return"gray"}}function S(n){if(n===0)return"0 B";const r=1024,c=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(n)/Math.log(r));return`${(n/Math.pow(r,o)).toFixed(2)} ${c[o]}`}function v(n,r){return r===0?0:Math.round(n/r*100)}function We(){var O,k;const{id:n}=Q(),{preferences:r}=me(),[c,o]=$.useState("overview"),{data:s,isLoading:h,error:f}=U({queryKey:["cluster",n,"stats"],queryFn:()=>p.getClusterStats(n),refetchInterval:r.refreshInterval,enabled:!!n}),{data:g,isLoading:x,error:l}=U({queryKey:["cluster",n,"nodes"],queryFn:()=>p.getNodes(n),refetchInterval:r.refreshInterval,enabled:!!n}),{data:j,isLoading:L,error:M}=U({queryKey:["cluster",n,"indices"],queryFn:()=>p.getIndices(n),refetchInterval:r.refreshInterval,enabled:!!n}),{data:b,isLoading:w,error:P}=U({queryKey:["cluster",n,"shards"],queryFn:()=>p.getShards(n),refetchInterval:r.refreshInterval,enabled:!!n});return n?h?e.jsx(q,{size:"xl",children:e.jsx(T,{justify:"center",mt:"xl",children:e.jsx(R,{size:"lg"})})}):f?e.jsx(q,{size:"xl",children:e.jsxs(E,{icon:e.jsx(N,{size:16}),title:"Error",color:"red",children:["Failed to load cluster information: ",f.message]})}):e.jsxs(q,{size:"xl",py:{base:"sm",sm:"md"},px:{base:"xs",sm:"md"},children:[e.jsxs(T,{justify:"space-between",mb:"md",wrap:"wrap",children:[e.jsxs("div",{children:[e.jsx(te,{order:1,className:"text-responsive-xl",children:(s==null?void 0:s.clusterName)||n}),e.jsx(a,{size:"sm",c:"dimmed",children:"Cluster Overview"})]}),e.jsx(T,{children:e.jsx(D,{size:"lg",color:ie((s==null?void 0:s.health)||"red"),children:((O=s==null?void 0:s.health)==null?void 0:O.toUpperCase())||"UNKNOWN"})})]}),e.jsxs(C,{mb:"md",children:[e.jsx(C.Col,{span:{base:12,sm:6,md:3},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Nodes"}),e.jsx(a,{size:"xl",fw:700,children:(s==null?void 0:s.numberOfNodes)||0}),e.jsxs(a,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.numberOfDataNodes)||0," data nodes"]})]})})}),e.jsx(C.Col,{span:{base:12,sm:6,md:3},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Indices"}),e.jsx(a,{size:"xl",fw:700,children:(s==null?void 0:s.numberOfIndices)||0}),e.jsxs(a,{size:"xs",c:"dimmed",children:[((k=s==null?void 0:s.numberOfDocuments)==null?void 0:k.toLocaleString())||0," documents"]})]})})}),e.jsx(C.Col,{span:{base:12,sm:6,md:3},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Shards"}),e.jsx(a,{size:"xl",fw:700,children:(s==null?void 0:s.activeShards)||0}),e.jsxs(a,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.activePrimaryShards)||0," primary"]})]})})}),e.jsx(C.Col,{span:{base:12,sm:6,md:3},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Unassigned"}),e.jsx(a,{size:"xl",fw:700,c:s!=null&&s.unassignedShards?"red":void 0,children:(s==null?void 0:s.unassignedShards)||0}),e.jsxs(a,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.relocatingShards)||0," relocating"]})]})})})]}),((s==null?void 0:s.memoryTotal)||(s==null?void 0:s.diskTotal))&&e.jsxs(C,{mb:"md",children:[(s==null?void 0:s.memoryTotal)&&e.jsx(C.Col,{span:{base:12,md:6},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Memory Usage"}),e.jsx(A,{value:v(s.memoryUsed||0,s.memoryTotal),color:v(s.memoryUsed||0,s.memoryTotal)>90?"red":"blue",size:"lg"}),e.jsxs(a,{size:"xs",c:"dimmed",children:[S(s.memoryUsed||0)," / ",S(s.memoryTotal)," (",v(s.memoryUsed||0,s.memoryTotal),"%)"]})]})})}),(s==null?void 0:s.diskTotal)&&e.jsx(C.Col,{span:{base:12,md:6},children:e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:"Disk Usage"}),e.jsx(A,{value:v(s.diskUsed||0,s.diskTotal),color:v(s.diskUsed||0,s.diskTotal)>90?"red":"blue",size:"lg"}),e.jsxs(a,{size:"xs",c:"dimmed",children:[S(s.diskUsed||0)," / ",S(s.diskTotal)," (",v(s.diskUsed||0,s.diskTotal),"%)"]})]})})})]}),e.jsx(z,{shadow:"sm",padding:"lg",children:e.jsxs(y,{value:c,onChange:o,children:[e.jsxs(y.List,{children:[e.jsx(y.Tab,{value:"overview",children:"Overview"}),e.jsxs(y.Tab,{value:"nodes",children:["Nodes (",(g==null?void 0:g.length)||0,")"]}),e.jsxs(y.Tab,{value:"indices",children:["Indices (",(j==null?void 0:j.length)||0,")"]}),e.jsxs(y.Tab,{value:"shards",children:["Shards (",(b==null?void 0:b.length)||0,")"]})]}),e.jsx(y.Panel,{value:"overview",pt:"md",children:e.jsxs(u,{gap:"md",children:[e.jsxs(a,{children:["This cluster has ",(s==null?void 0:s.numberOfNodes)||0," nodes with ",(s==null?void 0:s.activeShards)||0," active shards across ",(s==null?void 0:s.numberOfIndices)||0," indices."]}),s!=null&&s.unassignedShards?e.jsxs(E,{icon:e.jsx(N,{size:16}),title:"Warning",color:"yellow",children:["There are ",s.unassignedShards," unassigned shards in this cluster."]}):null]})}),e.jsx(y.Panel,{value:"nodes",pt:"md",children:e.jsx(Se,{nodes:g,loading:x,error:l})}),e.jsx(y.Panel,{value:"indices",pt:"md",children:e.jsx(be,{indices:j,loading:L,error:M})}),e.jsx(y.Panel,{value:"shards",pt:"md",children:e.jsx(ze,{shards:b,loading:w,error:P})})]})})]}):e.jsx(q,{size:"xl",children:e.jsx(E,{icon:e.jsx(N,{size:16}),title:"Error",color:"red",children:"Cluster ID is required"})})}function Se({nodes:n,loading:r,error:c}){const{id:o}=Q(),s=ee(),[h,f]=$.useState(""),g=ne(h,300),x=n==null?void 0:n.filter(l=>{var j;return l.name.toLowerCase().includes(g.toLowerCase())||((j=l.ip)==null?void 0:j.toLowerCase().includes(g.toLowerCase()))});return r?e.jsx(T,{justify:"center",py:"xl",children:e.jsx(R,{})}):c?e.jsxs(E,{icon:e.jsx(N,{size:16}),title:"Error",color:"red",children:["Failed to load nodes: ",c.message]}):!n||n.length===0?e.jsx(a,{c:"dimmed",children:"No nodes found"}):e.jsxs(u,{gap:"md",children:[e.jsx(H,{placeholder:"Search nodes...",leftSection:e.jsx(se,{size:16}),value:h,onChange:l=>f(l.currentTarget.value),style:{maxWidth:400}}),x&&x.length===0?e.jsx(a,{c:"dimmed",ta:"center",py:"xl",children:"No nodes match your search"}):e.jsx(G,{children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Name"}),e.jsx(i.Th,{children:"Roles"}),e.jsx(i.Th,{children:"Heap Usage"}),e.jsx(i.Th,{children:"Disk Usage"}),e.jsx(i.Th,{children:"CPU"})]})}),e.jsx(i.Tbody,{children:x==null?void 0:x.map(l=>e.jsxs(i.Tr,{style:{cursor:"pointer"},onClick:()=>s(`/cluster/${o}/nodes/${l.id}`),children:[e.jsxs(i.Td,{children:[e.jsx(a,{size:"sm",fw:500,children:l.name}),l.ip&&e.jsx(a,{size:"xs",c:"dimmed",children:l.ip})]}),e.jsx(i.Td,{children:e.jsx(T,{gap:"xs",children:l.roles.map(j=>e.jsx(D,{size:"sm",variant:"light",children:j},j))})}),e.jsx(i.Td,{children:e.jsxs(u,{gap:4,children:[e.jsx(A,{value:v(l.heapUsed,l.heapMax),color:v(l.heapUsed,l.heapMax)>90?"red":"blue",size:"sm"}),e.jsxs(a,{size:"xs",c:"dimmed",children:[S(l.heapUsed)," / ",S(l.heapMax)]})]})}),e.jsx(i.Td,{children:e.jsxs(u,{gap:4,children:[e.jsx(A,{value:v(l.diskUsed,l.diskTotal),color:v(l.diskUsed,l.diskTotal)>90?"red":"blue",size:"sm"}),e.jsxs(a,{size:"xs",c:"dimmed",children:[S(l.diskUsed)," / ",S(l.diskTotal)]})]})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:l.cpuPercent!==void 0?`${l.cpuPercent}%`:"N/A"})})]},l.id))})]})})]})}function be({indices:n,loading:r,error:c}){const{id:o}=Q(),s=ee(),[h,f]=$.useState(""),g=ne(h,300),x=n==null?void 0:n.filter(l=>l.name.toLowerCase().includes(g.toLowerCase()));return r?e.jsx(T,{justify:"center",py:"xl",children:e.jsx(R,{})}):c?e.jsxs(E,{icon:e.jsx(N,{size:16}),title:"Error",color:"red",children:["Failed to load indices: ",c.message]}):!n||n.length===0?e.jsxs(u,{gap:"md",align:"center",py:"xl",children:[e.jsx(a,{c:"dimmed",children:"No indices found"}),o&&e.jsx(F,{leftSection:e.jsx(Z,{size:16}),onClick:()=>s(`/cluster/${o}/indices/create`),children:"Create Index"})]}):e.jsxs(u,{gap:"md",children:[e.jsxs(T,{justify:"space-between",children:[e.jsx(H,{placeholder:"Search indices...",leftSection:e.jsx(se,{size:16}),value:h,onChange:l=>f(l.currentTarget.value),style:{flex:1,maxWidth:400}}),o&&e.jsx(F,{leftSection:e.jsx(Z,{size:16}),onClick:()=>s(`/cluster/${o}/indices/create`),children:"Create Index"})]}),x&&x.length===0?e.jsx(a,{c:"dimmed",ta:"center",py:"xl",children:"No indices match your search"}):e.jsx(G,{children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Name"}),e.jsx(i.Th,{children:"Health"}),e.jsx(i.Th,{children:"Status"}),e.jsx(i.Th,{children:"Documents"}),e.jsx(i.Th,{children:"Size"}),e.jsx(i.Th,{children:"Shards"}),e.jsx(i.Th,{children:"Actions"})]})}),e.jsx(i.Tbody,{children:x==null?void 0:x.map(l=>e.jsxs(i.Tr,{children:[e.jsx(i.Td,{children:e.jsx(a,{size:"sm",fw:500,children:l.name})}),e.jsx(i.Td,{children:e.jsx(D,{size:"sm",color:ie(l.health),children:l.health})}),e.jsx(i.Td,{children:e.jsx(D,{size:"sm",variant:"light",color:l.status==="open"?"green":"gray",children:l.status})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:l.docsCount.toLocaleString()})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:S(l.storeSize)})}),e.jsx(i.Td,{children:e.jsxs(a,{size:"sm",children:[l.primaryShards,"p / ",l.replicaShards,"r"]})}),e.jsx(i.Td,{children:e.jsxs(T,{gap:"xs",children:[o&&e.jsx(ve,{clusterId:o,index:l}),e.jsxs(m,{shadow:"md",width:200,children:[e.jsx(m.Target,{children:e.jsx(_,{variant:"subtle",color:"gray",children:e.jsx(re,{size:16})})}),e.jsxs(m.Dropdown,{children:[e.jsx(m.Label,{children:"Index Management"}),e.jsx(m.Item,{leftSection:e.jsx(ce,{size:14}),onClick:()=>s(`/cluster/${o}/indices/${l.name}/settings`),children:"Settings"}),e.jsx(m.Item,{leftSection:e.jsx(he,{size:14}),onClick:()=>s(`/cluster/${o}/indices/${l.name}/mappings`),children:"Mappings"})]})]})]})})]},l.name))})]})})]})}function ze({shards:n,loading:r,error:c}){if(r)return e.jsx(T,{justify:"center",py:"xl",children:e.jsx(R,{})});if(c)return e.jsxs(E,{icon:e.jsx(N,{size:16}),title:"Error",color:"red",children:["Failed to load shards: ",c.message]});if(!n||n.length===0)return e.jsx(a,{c:"dimmed",children:"No shards found"});const o=n.reduce((s,h)=>(s[h.state]||(s[h.state]=[]),s[h.state].push(h),s),{});return e.jsxs(u,{gap:"md",children:[e.jsx(C,{children:Object.entries(o).map(([s,h])=>e.jsx(C.Col,{span:{base:12,sm:6,md:3},children:e.jsx(z,{shadow:"sm",padding:"md",children:e.jsxs(u,{gap:"xs",children:[e.jsx(a,{size:"sm",c:"dimmed",children:s}),e.jsx(a,{size:"xl",fw:700,children:h.length})]})})},s))}),e.jsxs(G,{children:[e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Index"}),e.jsx(i.Th,{children:"Shard"}),e.jsx(i.Th,{children:"Type"}),e.jsx(i.Th,{children:"State"}),e.jsx(i.Th,{children:"Node"}),e.jsx(i.Th,{children:"Documents"}),e.jsx(i.Th,{children:"Size"})]})}),e.jsx(i.Tbody,{children:n.slice(0,100).map((s,h)=>{var f;return e.jsxs(i.Tr,{children:[e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:s.index})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:s.shard})}),e.jsx(i.Td,{children:e.jsx(D,{size:"sm",variant:"light",color:s.primary?"blue":"gray",children:s.primary?"Primary":"Replica"})}),e.jsx(i.Td,{children:e.jsx(D,{size:"sm",color:s.state==="STARTED"?"green":s.state==="UNASSIGNED"?"red":"yellow",children:s.state})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:s.node||"N/A"})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:((f=s.docs)==null?void 0:f.toLocaleString())||"N/A"})}),e.jsx(i.Td,{children:e.jsx(a,{size:"sm",children:s.store?S(s.store):"N/A"})})]},`${s.index}-${s.shard}-${h}`)})})]}),n.length>100&&e.jsxs(a,{size:"sm",c:"dimmed",ta:"center",mt:"md",children:["Showing first 100 of ",n.length," shards"]})]})]})}export{We as ClusterView};
