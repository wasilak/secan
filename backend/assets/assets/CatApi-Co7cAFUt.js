import{c as T,k as J,r as i,a as F,j as e,G as o,T as L,b as p,S as y,l as R,m as N,al as U,L as O,d as l,n as B,e as v}from"./index-CNRDdsta.js";import{u as W}from"./useMutation-CaYU4g6S.js";import{C as _}from"./Container-BPUIqV2j.js";import{A as b,I as k}from"./IconAlertCircle-xt26jQrX.js";import{B as I}from"./Button-C40bJwZS.js";import{I as X}from"./IconRefresh-R04wZp9t.js";import{C as A}from"./Card-C05VjDzn.js";import{S as Y}from"./Select-8Lz1TFJ1.js";import{A as j}from"./Accordion-DE5VxHs0.js";import{B as $}from"./Badge-DuQCXH5x.js";import{T as Z}from"./TextInput-BB78TaU7.js";import"./OptionsDropdown-Cm1MnTQn.js";import"./InputBase-CzYGjzOL.js";import"./get-safe-id-Bp3H8K0-.js";var ee=T("help","IconHelp",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 17l0 .01",key:"svg-1"}],["path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4",key:"svg-2"}]]),se=T("sort-ascending","IconSortAscending",[["path",{d:"M4 6l7 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l9 0",key:"svg-2"}],["path",{d:"M15 9l3 -3l3 3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]),te=T("sort-descending","IconSortDescending",[["path",{d:"M4 6l9 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l7 0",key:"svg-2"}],["path",{d:"M15 15l3 3l3 -3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]);const ae={aliases:"Show alias information",allocation:"Show shard allocation across nodes",count:"Show document counts",fielddata:"Show fielddata memory usage",health:"Show cluster health",indices:"Show index information",master:"Show master node",nodeattrs:"Show node attributes",nodes:"Show node information",pending_tasks:"Show pending cluster tasks",plugins:"Show installed plugins",recovery:"Show index recovery information",repositories:"Show snapshot repositories",segments:"Show segment information",shards:"Show shard information",snapshots:"Show snapshots",tasks:"Show running tasks",templates:"Show index templates",thread_pool:"Show thread pool statistics"};function fe(){const{id:r}=J(),[a,z]=i.useState(""),[d,M]=i.useState(""),[c,E]=i.useState(null),[u,f]=i.useState("asc"),[x,S]=i.useState(!1),{data:w}=F({queryKey:["cluster",r,"cat-endpoints"],queryFn:()=>v.getCatEndpoints(r),enabled:!!r}),t=W({mutationFn:s=>v.executeCatApi(r,s),onError:s=>{B.show({title:"Error",message:`Failed to execute Cat API: ${s.message}`,color:"red"})}}),{data:P}=F({queryKey:["cluster",r,"cat-help",a],queryFn:()=>v.getCatApiHelp(r,a),enabled:!!r&&!!a&&x}),G=()=>{if(!a){B.show({title:"Error",message:"Please select a Cat API endpoint",color:"red"});return}t.mutate(a)},K=()=>{z(""),M(""),E(null),f("asc"),S(!1),t.reset()},V=()=>{S(!x)},Q=s=>{c===s?f(u==="asc"?"desc":"asc"):(E(s),f("asc"))},H=i.useMemo(()=>!t.data||t.data.length===0?[]:Object.keys(t.data[0]),[t.data]),C=i.useMemo(()=>{if(!t.data)return[];let s=[...t.data];if(d.trim()){const m=d.toLowerCase();s=s.filter(n=>Object.values(n).some(h=>String(h).toLowerCase().includes(m)))}return c&&s.sort((m,n)=>{const h=m[c],g=n[c];if(typeof h=="number"&&typeof g=="number")return u==="asc"?h-g:g-h;const D=String(h).toLowerCase(),q=String(g).toLowerCase();return u==="asc"?D.localeCompare(q):q.localeCompare(D)}),s},[t.data,d,c,u]);return r?e.jsxs(_,{size:"xl",py:"md",children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsxs("div",{children:[e.jsx(L,{order:2,children:"Cat API"}),e.jsx(p,{size:"sm",c:"dimmed",children:"Access Elasticsearch Cat APIs for compact, human-readable cluster information"})]}),e.jsx(I,{leftSection:e.jsx(X,{size:16}),variant:"light",onClick:K,children:"Reset"})]}),e.jsxs(y,{gap:"md",children:[e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(y,{gap:"md",children:[e.jsx(Y,{label:"Cat API Endpoint",placeholder:"Select an endpoint",value:a,onChange:s=>{z(s||""),t.reset(),S(!1)},data:(w==null?void 0:w.map(s=>({value:s,label:`${s} - ${ae[s]||"No description"}`})))||[],searchable:!0,required:!0}),e.jsxs(o,{justify:"space-between",children:[e.jsx(I,{leftSection:e.jsx(ee,{size:16}),variant:"light",onClick:V,disabled:!a,children:x?"Hide Help":"Show Help"}),e.jsx(I,{leftSection:e.jsx(R,{size:16}),onClick:G,loading:t.isPending,disabled:!a,children:"Execute"})]}),x&&a&&e.jsx(j,{variant:"contained",children:e.jsxs(j.Item,{value:"help",children:[e.jsx(j.Control,{children:e.jsxs(p,{size:"sm",fw:500,children:["Help for ",a]})}),e.jsx(j.Panel,{children:P?e.jsx(N,{h:200,children:e.jsx(U,{block:!0,children:P})}):e.jsxs(o,{justify:"center",children:[e.jsx(O,{size:"sm"}),e.jsx(p,{size:"sm",children:"Loading help text..."})]})})]})})]})}),t.data&&t.data.length>0&&e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(y,{gap:"md",children:[e.jsxs(o,{justify:"space-between",children:[e.jsxs(o,{children:[e.jsx(L,{order:3,children:"Results"}),e.jsxs($,{size:"lg",variant:"light",children:[C.length," rows"]})]}),e.jsx(Z,{placeholder:"Filter results...",value:d,onChange:s=>M(s.currentTarget.value),style:{width:300},leftSection:e.jsx(R,{size:16})})]}),e.jsx(N,{children:e.jsxs(l,{striped:!0,highlightOnHover:!0,children:[e.jsx(l.Thead,{children:e.jsx(l.Tr,{children:H.map(s=>e.jsx(l.Th,{style:{cursor:"pointer",userSelect:"none"},onClick:()=>Q(s),children:e.jsxs(o,{gap:"xs",children:[e.jsx(p,{size:"sm",fw:500,children:s}),c===s&&(u==="asc"?e.jsx(se,{size:14}):e.jsx(te,{size:14}))]})},s))})}),e.jsx(l.Tbody,{children:C.map((s,m)=>e.jsx(l.Tr,{children:H.map(n=>e.jsx(l.Td,{children:typeof s[n]=="number"?e.jsx($,{variant:"light",children:s[n]}):e.jsx(p,{size:"sm",children:String(s[n])})},n))},m))})]})}),C.length===0&&d&&e.jsxs(b,{icon:e.jsx(k,{size:16}),color:"blue",variant:"light",children:['No results match the filter "',d,'"']})]})}),t.data&&t.data.length===0&&e.jsx(b,{icon:e.jsx(k,{size:16}),color:"blue",variant:"light",children:"No data returned from the Cat API endpoint"}),t.isPending&&e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(o,{justify:"center",children:[e.jsx(O,{size:"lg"}),e.jsx(p,{children:"Executing Cat API request..."})]})})]})]}):e.jsx(_,{size:"xl",children:e.jsx(b,{icon:e.jsx(k,{size:16}),title:"Error",color:"red",children:"Cluster ID is required"})})}export{fe as CatApiPage};
