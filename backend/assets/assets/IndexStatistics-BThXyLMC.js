import{H as z,h as v,r as F,k as B,j as e,A as f,I as g,G as p,L as D,l as h,m,ab as w,D as q,S as k,n as s,_ as R,o as $}from"./index-BkCsPiHX.js";import{C as a}from"./Container-SynUn5pH.js";import{B as I}from"./Button-DqgZGZc-.js";import{C as o}from"./Card-87qFB92N.js";import{G as t}from"./Grid-Ck1YAfRA.js";function j(i){if(i===0)return"0 B";const n=1024,c=["B","KB","MB","GB","TB"],x=Math.floor(Math.log(i)/Math.log(n));return`${(i/Math.pow(n,x)).toFixed(2)} ${c[x]}`}function l(i){return i<1e3?`${i}ms`:i<6e4?`${(i/1e3).toFixed(2)}s`:i<36e5?`${(i/6e4).toFixed(2)}m`:`${(i/36e5).toFixed(2)}h`}function d(i){return i.toLocaleString()}function T({title:i,value:n,description:c}){return e.jsxs(R,{p:"md",withBorder:!0,children:[e.jsx(m,{size:"xs",c:"dimmed",tt:"uppercase",fw:700,children:i}),e.jsx(m,{size:"xl",fw:700,mt:"xs",children:n}),c&&e.jsx(m,{size:"xs",c:"dimmed",mt:"xs",children:c})]})}function Q(){const{id:i,indexName:n}=z(),c=v(),[x,S]=F.useState("total"),{data:u,isLoading:M,error:C,refetch:y}=B({queryKey:["cluster",i,"index",n,"stats"],queryFn:async()=>{if(!i||!n)throw new Error("Cluster ID and index name are required");return await $.getIndexStats(i,n)},enabled:!!i&&!!n,refetchInterval:3e4});if(!i||!n)return e.jsx(a,{size:"xl",children:e.jsx(f,{icon:e.jsx(g,{size:16}),title:"Error",color:"red",children:"Cluster ID and index name are required"})});if(M)return e.jsx(a,{size:"xl",children:e.jsx(p,{justify:"center",mt:"xl",children:e.jsx(D,{size:"lg"})})});if(C)return e.jsx(a,{size:"xl",children:e.jsxs(f,{icon:e.jsx(g,{size:16}),title:"Error",color:"red",children:["Failed to load index statistics: ",C.message]})});if(!u)return e.jsx(a,{size:"xl",children:e.jsx(f,{icon:e.jsx(g,{size:16}),title:"Error",color:"red",children:"No statistics available for this index"})});const r=x==="total"?u.total:u.primaries;return e.jsxs(a,{size:"xl",py:"md",children:[e.jsxs(p,{justify:"space-between",mb:"md",children:[e.jsxs("div",{children:[e.jsx(h,{order:1,children:"Index Statistics"}),e.jsx(m,{size:"sm",c:"dimmed",children:n})]}),e.jsxs(p,{children:[e.jsx(w,{value:x,onChange:b=>S(b),data:[{value:"total",label:"Total (All Shards)"},{value:"primaries",label:"Primaries Only"}],w:200}),e.jsx(I,{variant:"default",leftSection:e.jsx(q,{size:16}),onClick:()=>y(),children:"Refresh"}),e.jsx(I,{variant:"default",onClick:()=>c(`/cluster/${i}`),children:"Back to Cluster"})]})]}),e.jsxs(k,{gap:"md",children:[e.jsxs(o,{shadow:"sm",padding:"lg",children:[e.jsx(h,{order:3,mb:"md",children:"Documents & Storage"}),e.jsxs(t,{children:[e.jsx(t.Col,{span:{base:12,sm:6,md:3},children:e.jsx(T,{title:"Document Count",value:d(r.docs.count),description:"Total documents in index"})}),e.jsx(t.Col,{span:{base:12,sm:6,md:3},children:e.jsx(T,{title:"Deleted Documents",value:d(r.docs.deleted),description:"Documents marked for deletion"})}),e.jsx(t.Col,{span:{base:12,sm:6,md:3},children:e.jsx(T,{title:"Storage Size",value:j(r.store.sizeInBytes),description:"Total disk space used"})}),e.jsx(t.Col,{span:{base:12,sm:6,md:3},children:e.jsx(T,{title:"Segments",value:d(r.segments.count),description:`Memory: ${j(r.segments.memoryInBytes)}`})})]})]}),e.jsxs(o,{shadow:"sm",padding:"lg",children:[e.jsx(h,{order:3,mb:"md",children:"Indexing Statistics"}),e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:"Metric"}),e.jsx(s.Th,{children:"Value"})]})}),e.jsxs(s.Tbody,{children:[e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Index Operations"}),e.jsx(s.Td,{children:d(r.indexing.indexTotal)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Index Time"}),e.jsx(s.Td,{children:l(r.indexing.indexTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Indexing Operations"}),e.jsx(s.Td,{children:d(r.indexing.indexCurrent)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Failed Index Operations"}),e.jsx(s.Td,{children:d(r.indexing.indexFailed)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Delete Operations"}),e.jsx(s.Td,{children:d(r.indexing.deleteTotal)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Delete Time"}),e.jsx(s.Td,{children:l(r.indexing.deleteTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Delete Operations"}),e.jsx(s.Td,{children:d(r.indexing.deleteCurrent)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Throttle Time"}),e.jsx(s.Td,{children:l(r.indexing.throttleTimeInMillis)})]})]})]})]}),e.jsxs(o,{shadow:"sm",padding:"lg",children:[e.jsx(h,{order:3,mb:"md",children:"Search Statistics"}),e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:"Metric"}),e.jsx(s.Th,{children:"Value"})]})}),e.jsxs(s.Tbody,{children:[e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Queries"}),e.jsx(s.Td,{children:d(r.search.queryTotal)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Query Time"}),e.jsx(s.Td,{children:l(r.search.queryTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Average Query Time"}),e.jsx(s.Td,{children:r.search.queryTotal>0?l(r.search.queryTimeInMillis/r.search.queryTotal):"0ms"})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Queries"}),e.jsx(s.Td,{children:d(r.search.queryCurrent)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Fetches"}),e.jsx(s.Td,{children:d(r.search.fetchTotal)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Fetch Time"}),e.jsx(s.Td,{children:l(r.search.fetchTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Fetches"}),e.jsx(s.Td,{children:d(r.search.fetchCurrent)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Scrolls"}),e.jsx(s.Td,{children:d(r.search.scrollTotal)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Scroll Time"}),e.jsx(s.Td,{children:l(r.search.scrollTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Scrolls"}),e.jsx(s.Td,{children:d(r.search.scrollCurrent)})]})]})]})]}),e.jsxs(o,{shadow:"sm",padding:"lg",children:[e.jsx(h,{order:3,mb:"md",children:"Merge Statistics"}),e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:"Metric"}),e.jsx(s.Th,{children:"Value"})]})}),e.jsxs(s.Tbody,{children:[e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Merges"}),e.jsx(s.Td,{children:d(r.merges.current)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Merge Docs"}),e.jsx(s.Td,{children:d(r.merges.currentDocs)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Current Merge Size"}),e.jsx(s.Td,{children:j(r.merges.currentSizeInBytes)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Merges"}),e.jsx(s.Td,{children:d(r.merges.total)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Merge Time"}),e.jsx(s.Td,{children:l(r.merges.totalTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Merged Docs"}),e.jsx(s.Td,{children:d(r.merges.totalDocs)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Merged Size"}),e.jsx(s.Td,{children:j(r.merges.totalSizeInBytes)})]})]})]})]}),e.jsxs(o,{shadow:"sm",padding:"lg",children:[e.jsx(h,{order:3,mb:"md",children:"Refresh & Flush Statistics"}),e.jsxs(t,{children:[e.jsx(t.Col,{span:{base:12,md:6},children:e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsx(s.Tr,{children:e.jsx(s.Th,{colSpan:2,children:"Refresh"})})}),e.jsxs(s.Tbody,{children:[e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Refreshes"}),e.jsx(s.Td,{children:d(r.refresh.total)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Refresh Time"}),e.jsx(s.Td,{children:l(r.refresh.totalTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Average Refresh Time"}),e.jsx(s.Td,{children:r.refresh.total>0?l(r.refresh.totalTimeInMillis/r.refresh.total):"0ms"})]})]})]})}),e.jsx(t.Col,{span:{base:12,md:6},children:e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsx(s.Tr,{children:e.jsx(s.Th,{colSpan:2,children:"Flush"})})}),e.jsxs(s.Tbody,{children:[e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Flushes"}),e.jsx(s.Td,{children:d(r.flush.total)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Total Flush Time"}),e.jsx(s.Td,{children:l(r.flush.totalTimeInMillis)})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:"Average Flush Time"}),e.jsx(s.Td,{children:r.flush.total>0?l(r.flush.totalTimeInMillis/r.flush.total):"0ms"})]})]})]})})]})]})]})]})}export{Q as IndexStatistics};
