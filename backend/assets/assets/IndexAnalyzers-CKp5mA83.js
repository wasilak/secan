import{O as B,r as F,k as C,j as e,A as g,I as u,G as d,X as G,l as j,S as A,a3 as J,a1 as K,m as I}from"./index-BOft62Ul.js";import{C as f}from"./Container-C4qPc78z.js";import{T as H}from"./Title-D9teK7Ra.js";import{T as c}from"./Tabs-DrhVDnJ3.js";import{B as l}from"./Badge-CRGjkFGH.js";import{C as p}from"./Card-DgqXyPaN.js";import{T as Q}from"./TextInput-CBfV56Z9.js";import{I as R}from"./IconFilter-B6pSu5lI.js";import{T as i}from"./Table-Jx5e40YY.js";import{C as m}from"./Code-CpkrT-QC.js";import{A as t}from"./Accordion-DXHa6FlW.js";import"./get-safe-id-Bp3H8K0-.js";function se(){const{id:a,indexName:h}=B(),[b,S]=F.useState(""),[v,w]=F.useState(""),{data:s,isLoading:O,error:P}=C({queryKey:["cluster",a,"index",h,"analyzers"],queryFn:()=>I.getIndexAnalyzers(a,h),enabled:!!a&&!!h}),{data:o,isLoading:L,error:N}=C({queryKey:["cluster",a,"index",h,"fields"],queryFn:()=>I.getIndexFields(a,h),enabled:!!a&&!!h});if(!a||!h)return e.jsx(f,{size:"xl",children:e.jsx(g,{icon:e.jsx(u,{size:16}),title:"Error",color:"red",children:"Cluster ID and index name are required"})});const E=O||L,T=P||N;if(E)return e.jsx(f,{size:"xl",children:e.jsx(d,{justify:"center",mt:"xl",children:e.jsx(G,{size:"lg"})})});if(T)return e.jsx(f,{size:"xl",children:e.jsxs(g,{icon:e.jsx(u,{size:16}),title:"Error",color:"red",children:["Failed to load index analyzers: ",T.message]})});const k=(o==null?void 0:o.fields.filter(r=>{const x=!b||r.name.toLowerCase().includes(b.toLowerCase()),n=!v||r.type===v;return x&&n}))||[],q=Array.from(new Set((o==null?void 0:o.fields.map(r=>r.type))||[])).sort();return e.jsxs(f,{size:"xl",py:"md",children:[e.jsx(d,{justify:"space-between",mb:"md",children:e.jsxs("div",{children:[e.jsx(H,{order:2,children:"Index Analyzers & Fields"}),e.jsx(j,{size:"sm",c:"dimmed",children:h})]})}),e.jsxs(c,{defaultValue:"fields",children:[e.jsxs(c.List,{children:[e.jsx(c.Tab,{value:"fields",children:e.jsxs(d,{gap:"xs",children:["Fields",e.jsx(l,{size:"sm",variant:"light",children:(o==null?void 0:o.fields.length)||0})]})}),e.jsx(c.Tab,{value:"analyzers",children:e.jsxs(d,{gap:"xs",children:["Analyzers",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.analyzers)||{}).length})]})}),e.jsx(c.Tab,{value:"tokenizers",children:e.jsxs(d,{gap:"xs",children:["Tokenizers",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.tokenizers)||{}).length})]})}),e.jsx(c.Tab,{value:"filters",children:e.jsxs(d,{gap:"xs",children:["Filters",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.filters)||{}).length})]})})]}),e.jsx(c.Panel,{value:"fields",pt:"md",children:e.jsxs(A,{gap:"md",children:[e.jsx(p,{shadow:"sm",padding:"md",children:e.jsxs(d,{grow:!0,children:[e.jsx(Q,{placeholder:"Filter by field name...",leftSection:e.jsx(J,{size:16}),value:b,onChange:r=>S(r.currentTarget.value)}),e.jsx(K,{placeholder:"Filter by type...",leftSection:e.jsx(R,{size:16}),value:v,onChange:r=>w(r||""),data:[{value:"",label:"All types"},...q.map(r=>({value:r,label:r}))],clearable:!0})]})}),e.jsx(p,{shadow:"sm",padding:"lg",children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Field Name"}),e.jsx(i.Th,{children:"Type"}),e.jsx(i.Th,{children:"Analyzer"}),e.jsx(i.Th,{children:"Search Analyzer"}),e.jsx(i.Th,{children:"Properties"})]})}),e.jsx(i.Tbody,{children:k.length===0?e.jsx(i.Tr,{children:e.jsx(i.Td,{colSpan:5,children:e.jsx(j,{ta:"center",c:"dimmed",children:"No fields found"})})}):k.map(r=>e.jsxs(i.Tr,{children:[e.jsx(i.Td,{children:e.jsx(m,{children:r.name})}),e.jsx(i.Td,{children:e.jsx(l,{variant:"light",color:"blue",children:r.type})}),e.jsx(i.Td,{children:r.analyzer?e.jsx(l,{variant:"light",color:"green",children:r.analyzer}):e.jsx(j,{size:"sm",c:"dimmed",children:"default"})}),e.jsx(i.Td,{children:r.searchAnalyzer?e.jsx(l,{variant:"light",color:"orange",children:r.searchAnalyzer}):e.jsx(j,{size:"sm",c:"dimmed",children:"-"})}),e.jsx(i.Td,{children:e.jsxs(d,{gap:"xs",children:[r.searchable&&e.jsx(l,{size:"xs",variant:"light",color:"blue",children:"Searchable"}),r.aggregatable&&e.jsx(l,{size:"xs",variant:"light",color:"green",children:"Aggregatable"}),r.stored&&e.jsx(l,{size:"xs",variant:"light",color:"orange",children:"Stored"})]})})]},r.name))})]})})]})}),e.jsx(c.Panel,{value:"analyzers",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.analyzers)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom analyzers configured for this index. The index uses built-in Elasticsearch analyzers."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.analyzers)||{}).map(([r,x])=>{const n=x;return e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsxs(d,{justify:"space-between",children:[e.jsx(m,{children:r}),n.type&&e.jsx(l,{variant:"light",color:"blue",children:n.type})]})}),e.jsx(t.Panel,{children:e.jsxs(A,{gap:"sm",children:[n.tokenizer&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Tokenizer:"}),e.jsx(l,{variant:"light",color:"green",children:n.tokenizer})]}),n.charFilter&&n.charFilter.length>0&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Character Filters:"}),e.jsx(d,{gap:"xs",children:n.charFilter.map((z,y)=>e.jsx(l,{variant:"light",color:"orange",children:z},y))})]}),n.filter&&n.filter.length>0&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Token Filters:"}),e.jsx(d,{gap:"xs",children:n.filter.map((z,y)=>e.jsx(l,{variant:"light",color:"purple",children:z},y))})]})]})})]},r)})})})}),e.jsx(c.Panel,{value:"tokenizers",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.tokenizers)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom tokenizers configured for this index."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.tokenizers)||{}).map(([r,x])=>e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsx(m,{children:r})}),e.jsx(t.Panel,{children:e.jsx(m,{block:!0,children:JSON.stringify(x,null,2)})})]},r))})})}),e.jsx(c.Panel,{value:"filters",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.filters)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom token filters configured for this index."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.filters)||{}).map(([r,x])=>e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsx(m,{children:r})}),e.jsx(t.Panel,{children:e.jsx(m,{block:!0,children:JSON.stringify(x,null,2)})})]},r))})})})]})]})}export{se as IndexAnalyzersPage};
