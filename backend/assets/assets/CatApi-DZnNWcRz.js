import{c as T,O as J,r as i,b as q,j as e,A as y,I as v,G as o,T as F,d as p,J as U,S as b,ae as W,Q as L,R as N,af as X,L as O,e as l,E as B,f as k}from"./index-BowZsXkX.js";import{u as Y}from"./useMutation-DabcCJzP.js";import{C as _}from"./Container-DabZTcok.js";import{B as I}from"./Button-DVKpOCXJ.js";import{C as A}from"./Card-CBHGju0x.js";import{A as j}from"./Accordion-DWLnSSsG.js";import{B as $}from"./Badge-i5KzbEI-.js";import{T as Z}from"./TextInput-f_LPQEHf.js";import"./get-safe-id-Bp3H8K0-.js";var ee=T("help","IconHelp",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 17l0 .01",key:"svg-1"}],["path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4",key:"svg-2"}]]),se=T("sort-ascending","IconSortAscending",[["path",{d:"M4 6l7 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l9 0",key:"svg-2"}],["path",{d:"M15 9l3 -3l3 3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]),te=T("sort-descending","IconSortDescending",[["path",{d:"M4 6l9 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l7 0",key:"svg-2"}],["path",{d:"M15 15l3 3l3 -3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]);const ae={aliases:"Show alias information",allocation:"Show shard allocation across nodes",count:"Show document counts",fielddata:"Show fielddata memory usage",health:"Show cluster health",indices:"Show index information",master:"Show master node",nodeattrs:"Show node attributes",nodes:"Show node information",pending_tasks:"Show pending cluster tasks",plugins:"Show installed plugins",recovery:"Show index recovery information",repositories:"Show snapshot repositories",segments:"Show segment information",shards:"Show shard information",snapshots:"Show snapshots",tasks:"Show running tasks",templates:"Show index templates",thread_pool:"Show thread pool statistics"};function ue(){const{id:r}=J(),[a,z]=i.useState(""),[d,E]=i.useState(""),[c,M]=i.useState(null),[u,f]=i.useState("asc"),[g,S]=i.useState(!1),{data:w}=q({queryKey:["cluster",r,"cat-endpoints"],queryFn:()=>k.getCatEndpoints(r),enabled:!!r}),t=Y({mutationFn:s=>k.executeCatApi(r,s),onError:s=>{B.show({title:"Error",message:`Failed to execute Cat API: ${s.message}`,color:"red"})}}),{data:P}=q({queryKey:["cluster",r,"cat-help",a],queryFn:()=>k.getCatApiHelp(r,a),enabled:!!r&&!!a&&g}),G=()=>{if(!a){B.show({title:"Error",message:"Please select a Cat API endpoint",color:"red"});return}t.mutate(a)},K=()=>{z(""),E(""),M(null),f("asc"),S(!1),t.reset()},Q=()=>{S(!g)},V=s=>{c===s?f(u==="asc"?"desc":"asc"):(M(s),f("asc"))},H=i.useMemo(()=>!t.data||t.data.length===0?[]:Object.keys(t.data[0]),[t.data]),C=i.useMemo(()=>{if(!t.data)return[];let s=[...t.data];if(d.trim()){const x=d.toLowerCase();s=s.filter(n=>Object.values(n).some(h=>String(h).toLowerCase().includes(x)))}return c&&s.sort((x,n)=>{const h=x[c],m=n[c];if(typeof h=="number"&&typeof m=="number")return u==="asc"?h-m:m-h;const D=String(h).toLowerCase(),R=String(m).toLowerCase();return u==="asc"?D.localeCompare(R):R.localeCompare(D)}),s},[t.data,d,c,u]);return r?e.jsxs(_,{size:"xl",py:"md",children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsxs("div",{children:[e.jsx(F,{order:2,children:"Cat API"}),e.jsx(p,{size:"sm",c:"dimmed",children:"Access Elasticsearch Cat APIs for compact, human-readable cluster information"})]}),e.jsx(I,{leftSection:e.jsx(U,{size:16}),variant:"light",onClick:K,children:"Reset"})]}),e.jsxs(b,{gap:"md",children:[e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(b,{gap:"md",children:[e.jsx(W,{label:"Cat API Endpoint",placeholder:"Select an endpoint",value:a,onChange:s=>{z(s||""),t.reset(),S(!1)},data:(w==null?void 0:w.map(s=>({value:s,label:`${s} - ${ae[s]||"No description"}`})))||[],searchable:!0,required:!0}),e.jsxs(o,{justify:"space-between",children:[e.jsx(I,{leftSection:e.jsx(ee,{size:16}),variant:"light",onClick:Q,disabled:!a,children:g?"Hide Help":"Show Help"}),e.jsx(I,{leftSection:e.jsx(L,{size:16}),onClick:G,loading:t.isPending,disabled:!a,children:"Execute"})]}),g&&a&&e.jsx(j,{variant:"contained",children:e.jsxs(j.Item,{value:"help",children:[e.jsx(j.Control,{children:e.jsxs(p,{size:"sm",fw:500,children:["Help for ",a]})}),e.jsx(j.Panel,{children:P?e.jsx(N,{h:200,children:e.jsx(X,{block:!0,children:P})}):e.jsxs(o,{justify:"center",children:[e.jsx(O,{size:"sm"}),e.jsx(p,{size:"sm",children:"Loading help text..."})]})})]})})]})}),t.data&&t.data.length>0&&e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(b,{gap:"md",children:[e.jsxs(o,{justify:"space-between",children:[e.jsxs(o,{children:[e.jsx(F,{order:3,children:"Results"}),e.jsxs($,{size:"lg",variant:"light",children:[C.length," rows"]})]}),e.jsx(Z,{placeholder:"Filter results...",value:d,onChange:s=>E(s.currentTarget.value),style:{width:300},leftSection:e.jsx(L,{size:16})})]}),e.jsx(N,{children:e.jsxs(l,{striped:!0,highlightOnHover:!0,children:[e.jsx(l.Thead,{children:e.jsx(l.Tr,{children:H.map(s=>e.jsx(l.Th,{style:{cursor:"pointer",userSelect:"none"},onClick:()=>V(s),children:e.jsxs(o,{gap:"xs",children:[e.jsx(p,{size:"sm",fw:500,children:s}),c===s&&(u==="asc"?e.jsx(se,{size:14}):e.jsx(te,{size:14}))]})},s))})}),e.jsx(l.Tbody,{children:C.map((s,x)=>e.jsx(l.Tr,{children:H.map(n=>e.jsx(l.Td,{children:typeof s[n]=="number"?e.jsx($,{variant:"light",children:s[n]}):e.jsx(p,{size:"sm",children:String(s[n])})},n))},x))})]})}),C.length===0&&d&&e.jsxs(y,{icon:e.jsx(v,{size:16}),color:"blue",variant:"light",children:['No results match the filter "',d,'"']})]})}),t.data&&t.data.length===0&&e.jsx(y,{icon:e.jsx(v,{size:16}),color:"blue",variant:"light",children:"No data returned from the Cat API endpoint"}),t.isPending&&e.jsx(A,{shadow:"sm",padding:"lg",children:e.jsxs(o,{justify:"center",children:[e.jsx(O,{size:"lg"}),e.jsx(p,{children:"Executing Cat API request..."})]})})]})]}):e.jsx(_,{size:"xl",children:e.jsx(y,{icon:e.jsx(v,{size:16}),title:"Error",color:"red",children:"Cluster ID is required"})})}export{ue as CatApiPage};
