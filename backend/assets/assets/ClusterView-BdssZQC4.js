import{r as N,h as qe,i as se,k as re,l as de,m as ke,j as e,U as Ve,n as he,o as me,p as Ie,B as ce,q as ze,s as X,t as we,v as $e,w as Qe,x as Ke,c as ne,y as He,z as be,D as w,f as P,M,E as Je,F as Me,H as Ze,J as Se,S as k,d as l,G as I,K as ae,a as Xe,N as te,b as Z,A as q,I as V,L as Q,T as Ye,u as ue,O as oe,P as ie,e as i,Q as Te,R as es,V as ss}from"./index-Bt6cuxqh.js";import{u as A}from"./useMutation-CAENEphD.js";import{u as rs}from"./accessibility-r9Ucgj9E.js";import{I as ns}from"./IconRefresh-DVfdWSy3.js";import{I as as}from"./IconDeviceFloppy-BFKAbc6K.js";import{I as ts}from"./IconTrash-CccuDp_P.js";import{T as K}from"./TextInput-DCXSX6Yu.js";import{B as W}from"./Button-CJn9sQpo.js";import{N as os}from"./NumberInput-Chv1H19a.js";import{B as U}from"./Badge-FHhY_7-1.js";import{G as L}from"./Grid-UX8-v_7J.js";import{C as R}from"./Card-Dwru4Zec.js";import{P as Y}from"./Progress-Cel5iIe1.js";import{T as E}from"./Tabs-DXaC_zOC.js";import{M as ee}from"./MultiSelect-DbTRl-VA.js";import{g as Pe}from"./get-auto-contrast-value-Da6zqqWm.js";import{I as is,a as ls,b as cs}from"./InputsGroupFieldset-pVhFceDo.js";import{C as Fe}from"./OptionsDropdown-CH2B_l2X.js";import"./InputBase-BZCD2cpm.js";import"./get-safe-id-Bp3H8K0-.js";const Ne=N.createContext(null),ds=Ne.Provider,Ee=()=>N.useContext(Ne),[hs,ms]=qe();var Le={card:"m_26775b0a"};const us={withBorder:!0},xs=he((t,{radius:n})=>({card:{"--card-radius":me(n)}})),xe=se((t,n)=>{const d=re("CheckboxCard",us,t),{classNames:h,className:u,style:f,styles:p,unstyled:s,vars:C,checked:v,mod:m,withBorder:x,value:g,onClick:j,defaultChecked:r,onChange:o,...c}=d,y=de({name:"CheckboxCard",classes:Le,props:d,className:u,style:f,classNames:h,styles:p,unstyled:s,vars:C,varsResolver:xs,rootSelector:"card"}),a=Ee(),b=typeof v=="boolean"?v:a?a.value.includes(g||""):void 0,[S,z]=ke({value:b,defaultValue:r,finalValue:!1,onChange:o});return e.jsx(hs,{value:{checked:S},children:e.jsx(Ve,{ref:n,mod:[{"with-border":x,checked:S},m],...y("card"),...c,role:"checkbox","aria-checked":S,onClick:$=>{j==null||j($),a==null||a.onChange(g||""),z(!S)}})})});xe.displayName="@mantine/core/CheckboxCard";xe.classes=Le;const ps={},pe=se((t,n)=>{const{value:d,defaultValue:h,onChange:u,size:f,wrapperProps:p,children:s,readOnly:C,...v}=re("CheckboxGroup",ps,t),[m,x]=ke({value:d,defaultValue:h,finalValue:[],onChange:u}),g=j=>{const r=typeof j=="string"?j:j.currentTarget.value;!C&&x(m.includes(r)?m.filter(o=>o!==r):[...m,r])};return e.jsx(ds,{value:{value:m,onChange:g,size:f},children:e.jsx(Ie.Wrapper,{size:f,ref:n,...p,...v,labelElement:"div",__staticSelector:"CheckboxGroup",children:e.jsx(is,{role:"group",children:s})})})});pe.classes=Ie.Wrapper.classes;pe.displayName="@mantine/core/CheckboxGroup";var Oe={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const gs={icon:Fe},js=he((t,{radius:n,color:d,size:h,iconColor:u,variant:f,autoContrast:p})=>{const s=ze({color:d||t.primaryColor,theme:t}),C=s.isThemeColor&&s.shade===void 0?`var(--mantine-color-${s.color}-outline)`:s.color;return{indicator:{"--checkbox-size":$e(h,"checkbox-size"),"--checkbox-radius":n===void 0?void 0:me(n),"--checkbox-color":f==="outline"?C:X(d,t),"--checkbox-icon-color":u?X(u,t):Pe(p,t)?we({color:d,theme:t,autoContrast:p}):void 0}}}),ge=se((t,n)=>{const d=re("CheckboxIndicator",gs,t),{classNames:h,className:u,style:f,styles:p,unstyled:s,vars:C,icon:v,indeterminate:m,radius:x,color:g,iconColor:j,autoContrast:r,checked:o,mod:c,variant:y,disabled:a,...b}=d,S=v,z=de({name:"CheckboxIndicator",classes:Oe,props:d,className:u,style:f,classNames:h,styles:p,unstyled:s,vars:C,varsResolver:js,rootSelector:"indicator"}),$=ms(),D=typeof o=="boolean"||typeof m=="boolean"?o||m:($==null?void 0:$.checked)||!1;return e.jsx(ce,{ref:n,...z("indicator",{variant:y}),variant:y,mod:[{checked:D,disabled:a},c],...b,children:e.jsx(S,{indeterminate:m,...z("icon")})})});ge.displayName="@mantine/core/CheckboxIndicator";ge.classes=Oe;var Re={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const fs={labelPosition:"right",icon:Fe},ys=he((t,{radius:n,color:d,size:h,iconColor:u,variant:f,autoContrast:p})=>{const s=ze({color:d||t.primaryColor,theme:t}),C=s.isThemeColor&&s.shade===void 0?`var(--mantine-color-${s.color}-outline)`:s.color;return{root:{"--checkbox-size":$e(h,"checkbox-size"),"--checkbox-radius":n===void 0?void 0:me(n),"--checkbox-color":f==="outline"?C:X(d,t),"--checkbox-icon-color":u?X(u,t):Pe(p,t)?we({color:d,theme:t,autoContrast:p}):void 0}}}),B=se((t,n)=>{const d=re("Checkbox",fs,t),{classNames:h,className:u,style:f,styles:p,unstyled:s,vars:C,color:v,label:m,id:x,size:g,radius:j,wrapperProps:r,checked:o,labelPosition:c,description:y,error:a,disabled:b,variant:S,indeterminate:z,icon:$,rootRef:D,iconColor:T,onChange:H,autoContrast:ws,mod:De,...Ae}=d,G=Ee(),Be=g||(G==null?void 0:G.size),Ge=$,J=de({name:"Checkbox",props:d,classes:Re,className:u,style:f,classNames:h,styles:p,unstyled:s,vars:C,varsResolver:ys}),{styleProps:_e,rest:fe}=Qe(Ae),ye=Ke(x),Ce=G?{checked:G.value.includes(fe.value),onChange:ve=>{G.onChange(ve),H==null||H(ve)}}:{},We=N.useRef(null),_=n||We;return N.useEffect(()=>{_&&"current"in _&&_.current&&(_.current.indeterminate=z||!1)},[z,_]),e.jsx(ls,{...J("root"),__staticSelector:"Checkbox",__stylesApiProps:d,id:ye,size:Be,labelPosition:c,label:m,description:y,error:a,disabled:b,classNames:h,styles:p,unstyled:s,"data-checked":Ce.checked||o||void 0,variant:S,ref:D,mod:De,..._e,...r,children:e.jsxs(ce,{...J("inner"),mod:{"data-label-position":c},children:[e.jsx(ce,{component:"input",id:ye,ref:_,checked:o,disabled:b,mod:{error:!!a,indeterminate:z},...J("input",{focusable:!0,variant:S}),onChange:H,...fe,...Ce,type:"checkbox"}),e.jsx(Ge,{indeterminate:z,...J("icon")})]})})});B.classes={...Re,...cs};B.displayName="@mantine/core/Checkbox";B.Group=pe;B.Indicator=ge;B.Card=xe;var Ue=ne("dots","IconDots",[["path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]),Cs=ne("eraser","IconEraser",[["path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3",key:"svg-0"}],["path",{d:"M18 13.3l-6.3 -6.3",key:"svg-1"}]]),vs=ne("folder-off","IconFolderOff",[["path",{d:"M8 4h1l3 3h7a2 2 0 0 1 2 2v8m-2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 1.189 -1.829",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]),bs=ne("folder-open","IconFolderOpen",[["path",{d:"M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2",key:"svg-0"}]]);function le(t,n=300){const[d,h]=N.useState(t);return N.useEffect(()=>{const u=setTimeout(()=>{h(t)},n);return()=>{clearTimeout(u)}},[t,n]),d}function Ss({clusterId:t,index:n}){const d=He(),{announceSuccess:h,announceError:u}=rs(),[f,{open:p,close:s}]=be(!1),[C,{open:v,close:m}]=be(!1),[x,g]=N.useState(""),[j,r]=N.useState(1),o=A({mutationFn:()=>P.openIndex(t,n.name),onMutate:()=>{w.show({id:`open-${n.name}`,title:"Opening index",message:`Opening index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`open-${n.name}`,title:"Success",message:`Index ${n.name} opened successfully`,color:"green",loading:!1,autoClose:3e3}),h(`Index ${n.name} opened successfully`),d.invalidateQueries({queryKey:["cluster",t,"indices"]})},onError:T=>{w.update({id:`open-${n.name}`,title:"Error",message:`Failed to open index: ${T.message}`,color:"red",loading:!1,autoClose:5e3}),u(`Failed to open index: ${T.message}`)}}),c=A({mutationFn:()=>P.closeIndex(t,n.name),onMutate:()=>{w.show({id:`close-${n.name}`,title:"Closing index",message:`Closing index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`close-${n.name}`,title:"Success",message:`Index ${n.name} closed successfully`,color:"green",loading:!1,autoClose:3e3}),d.invalidateQueries({queryKey:["cluster",t,"indices"]})},onError:T=>{w.update({id:`close-${n.name}`,title:"Error",message:`Failed to close index: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),y=A({mutationFn:()=>P.deleteIndex(t,n.name),onMutate:()=>{w.show({id:`delete-${n.name}`,title:"Deleting index",message:`Deleting index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`delete-${n.name}`,title:"Success",message:`Index ${n.name} deleted successfully`,color:"green",loading:!1,autoClose:3e3}),d.invalidateQueries({queryKey:["cluster",t,"indices"]}),s(),g("")},onError:T=>{w.update({id:`delete-${n.name}`,title:"Error",message:`Failed to delete index: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),a=A({mutationFn:T=>P.forceMergeIndex(t,n.name,T),onMutate:()=>{w.show({id:`forcemerge-${n.name}`,title:"Force merging index",message:`Force merging index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`forcemerge-${n.name}`,title:"Success",message:`Index ${n.name} force merged successfully`,color:"green",loading:!1,autoClose:3e3}),m(),r(1)},onError:T=>{w.update({id:`forcemerge-${n.name}`,title:"Error",message:`Failed to force merge index: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),b=A({mutationFn:()=>P.clearCacheIndex(t,n.name),onMutate:()=>{w.show({id:`clearcache-${n.name}`,title:"Clearing cache",message:`Clearing cache for index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`clearcache-${n.name}`,title:"Success",message:`Cache cleared for index ${n.name}`,color:"green",loading:!1,autoClose:3e3})},onError:T=>{w.update({id:`clearcache-${n.name}`,title:"Error",message:`Failed to clear cache: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),S=A({mutationFn:()=>P.refreshIndex(t,n.name),onMutate:()=>{w.show({id:`refresh-${n.name}`,title:"Refreshing index",message:`Refreshing index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`refresh-${n.name}`,title:"Success",message:`Index ${n.name} refreshed successfully`,color:"green",loading:!1,autoClose:3e3})},onError:T=>{w.update({id:`refresh-${n.name}`,title:"Error",message:`Failed to refresh index: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),z=A({mutationFn:()=>P.flushIndex(t,n.name),onMutate:()=>{w.show({id:`flush-${n.name}`,title:"Flushing index",message:`Flushing index ${n.name}...`,loading:!0,autoClose:!1})},onSuccess:()=>{w.update({id:`flush-${n.name}`,title:"Success",message:`Index ${n.name} flushed successfully`,color:"green",loading:!1,autoClose:3e3})},onError:T=>{w.update({id:`flush-${n.name}`,title:"Error",message:`Failed to flush index: ${T.message}`,color:"red",loading:!1,autoClose:5e3})}}),$=()=>{x===n.name&&y.mutate()},D=()=>{const T=typeof j=="number"?j:parseInt(j,10);!isNaN(T)&&T>0&&a.mutate(T)};return e.jsxs(e.Fragment,{children:[e.jsxs(M,{shadow:"md",width:200,children:[e.jsx(M.Target,{children:e.jsx(Je,{label:"Index operations",children:e.jsx(Me,{variant:"subtle",color:"gray","aria-label":`Operations for index ${n.name}`,children:e.jsx(Ue,{size:16,"aria-hidden":"true"})})})}),e.jsxs(M.Dropdown,{children:[e.jsx(M.Label,{children:"Index Operations"}),n.status==="close"?e.jsx(M.Item,{leftSection:e.jsx(bs,{size:14,"aria-hidden":"true"}),onClick:()=>o.mutate(),disabled:o.isPending,children:"Open Index"}):e.jsx(M.Item,{leftSection:e.jsx(vs,{size:14,"aria-hidden":"true"}),onClick:()=>c.mutate(),disabled:c.isPending,children:"Close Index"}),e.jsx(M.Item,{leftSection:e.jsx(ns,{size:14,"aria-hidden":"true"}),onClick:()=>S.mutate(),disabled:S.isPending,children:"Refresh"}),e.jsx(M.Item,{leftSection:e.jsx(as,{size:14,"aria-hidden":"true"}),onClick:()=>z.mutate(),disabled:z.isPending,children:"Flush"}),e.jsx(M.Item,{leftSection:e.jsx(Cs,{size:14,"aria-hidden":"true"}),onClick:()=>b.mutate(),disabled:b.isPending,children:"Clear Cache"}),e.jsx(M.Item,{leftSection:e.jsx(Ze,{size:14,"aria-hidden":"true"}),onClick:v,children:"Force Merge"}),e.jsx(M.Divider,{}),e.jsx(M.Item,{leftSection:e.jsx(ts,{size:14,"aria-hidden":"true"}),color:"red",onClick:p,children:"Delete Index"})]})]}),e.jsx(Se,{opened:f,onClose:()=>{s(),g("")},title:"Delete Index",centered:!0,"aria-labelledby":"delete-modal-title","aria-describedby":"delete-modal-description",children:e.jsxs(k,{gap:"md",children:[e.jsxs(l,{size:"sm",id:"delete-modal-description",children:["Are you sure you want to delete index ",e.jsx(l,{span:!0,fw:700,children:n.name}),"? This action cannot be undone."]}),e.jsx(l,{size:"sm",c:"dimmed",children:"Type the index name to confirm:"}),e.jsx(K,{placeholder:n.name,value:x,onChange:T=>g(T.currentTarget.value),"data-autofocus":!0,"aria-label":"Confirm index name","aria-required":"true"}),e.jsxs(I,{justify:"flex-end",children:[e.jsx(W,{variant:"default",onClick:()=>{s(),g("")},children:"Cancel"}),e.jsx(W,{color:"red",onClick:$,disabled:x!==n.name||y.isPending,loading:y.isPending,"aria-label":`Delete index ${n.name}`,children:"Delete"})]})]})}),e.jsx(Se,{opened:C,onClose:()=>{m(),r(1)},title:"Force Merge Index",centered:!0,"aria-labelledby":"forcemerge-modal-title","aria-describedby":"forcemerge-modal-description",children:e.jsxs(k,{gap:"md",children:[e.jsxs(l,{size:"sm",id:"forcemerge-modal-description",children:["Force merge index ",e.jsx(l,{span:!0,fw:700,children:n.name})," to reduce the number of segments."]}),e.jsx(os,{label:"Maximum number of segments",description:"The number of segments to merge to. Set to 1 for a single segment.",placeholder:"1",value:j,onChange:r,min:1,max:100,"aria-label":"Maximum number of segments","aria-required":"true"}),e.jsxs(I,{justify:"flex-end",children:[e.jsx(W,{variant:"default",onClick:()=>{m(),r(1)},children:"Cancel"}),e.jsx(W,{onClick:D,disabled:a.isPending,loading:a.isPending,"aria-label":`Force merge index ${n.name}`,children:"Force Merge"})]})]})})]})}function je(t){switch(t){case"green":return"green";case"yellow":return"yellow";case"red":return"red";default:return"gray"}}function F(t){if(t===0)return"0 B";const n=1024,d=["B","KB","MB","GB","TB"],h=Math.floor(Math.log(t)/Math.log(n));return`${(t/Math.pow(n,h)).toFixed(2)} ${d[h]}`}function O(t,n){return n===0?0:Math.round(t/n*100)}function Hs(){var b,S;const{id:t}=ae(),{preferences:n}=Xe(),[d,h]=te(),u=d.get("tab")||"overview",f=z=>{z&&h({tab:z})},p=z=>{h({tab:z})},{data:s,isLoading:C,error:v}=Z({queryKey:["cluster",t,"stats"],queryFn:()=>P.getClusterStats(t),refetchInterval:n.refreshInterval,enabled:!!t}),{data:m,isLoading:x,error:g}=Z({queryKey:["cluster",t,"nodes"],queryFn:()=>P.getNodes(t),refetchInterval:n.refreshInterval,enabled:!!t}),{data:j,isLoading:r,error:o}=Z({queryKey:["cluster",t,"indices"],queryFn:()=>P.getIndices(t),refetchInterval:n.refreshInterval,enabled:!!t}),{data:c,isLoading:y,error:a}=Z({queryKey:["cluster",t,"shards"],queryFn:()=>P.getShards(t),refetchInterval:n.refreshInterval,enabled:!!t});return t?C?e.jsx(k,{p:"md",children:e.jsx(I,{justify:"center",mt:"xl",children:e.jsx(Q,{size:"lg"})})}):v?e.jsx(k,{p:"md",children:e.jsxs(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:["Failed to load cluster information: ",v.message]})}):e.jsxs(k,{gap:"md",p:"md",children:[e.jsxs(I,{justify:"space-between",wrap:"wrap",children:[e.jsxs("div",{children:[e.jsx(Ye,{order:1,className:"text-responsive-xl",children:(s==null?void 0:s.clusterName)||t}),e.jsx(l,{size:"sm",c:"dimmed",children:"Cluster Overview"})]}),e.jsx(I,{children:e.jsx(U,{size:"lg",color:je((s==null?void 0:s.health)||"red"),children:((b=s==null?void 0:s.health)==null?void 0:b.toUpperCase())||"UNKNOWN"})})]}),e.jsxs(L,{children:[e.jsx(L.Col,{span:{base:12,sm:6,md:3},children:e.jsx(R,{shadow:"sm",padding:"lg",style:{cursor:"pointer"},onClick:()=>p("nodes"),children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Nodes"}),e.jsx(l,{size:"xl",fw:700,children:(s==null?void 0:s.numberOfNodes)||0}),e.jsxs(l,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.numberOfDataNodes)||0," data nodes"]})]})})}),e.jsx(L.Col,{span:{base:12,sm:6,md:3},children:e.jsx(R,{shadow:"sm",padding:"lg",style:{cursor:"pointer"},onClick:()=>p("indices"),children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Indices"}),e.jsx(l,{size:"xl",fw:700,children:(s==null?void 0:s.numberOfIndices)||0}),e.jsxs(l,{size:"xs",c:"dimmed",children:[((S=s==null?void 0:s.numberOfDocuments)==null?void 0:S.toLocaleString())||0," documents"]})]})})}),e.jsx(L.Col,{span:{base:12,sm:6,md:3},children:e.jsx(R,{shadow:"sm",padding:"lg",style:{cursor:"pointer"},onClick:()=>p("shards"),children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Shards"}),e.jsx(l,{size:"xl",fw:700,children:(s==null?void 0:s.activeShards)||0}),e.jsxs(l,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.activePrimaryShards)||0," primary"]})]})})}),e.jsx(L.Col,{span:{base:12,sm:6,md:3},children:e.jsx(R,{shadow:"sm",padding:"lg",style:{cursor:"pointer"},onClick:()=>p("shards"),children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Unassigned"}),e.jsx(l,{size:"xl",fw:700,c:s!=null&&s.unassignedShards?"red":void 0,children:(s==null?void 0:s.unassignedShards)||0}),e.jsxs(l,{size:"xs",c:"dimmed",children:[(s==null?void 0:s.relocatingShards)||0," relocating"]})]})})})]}),((s==null?void 0:s.memoryTotal)||(s==null?void 0:s.diskTotal))&&e.jsxs(L,{children:[(s==null?void 0:s.memoryTotal)&&e.jsx(L.Col,{span:{base:12,md:6},children:e.jsx(R,{shadow:"sm",padding:"lg",children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Memory Usage"}),e.jsx(Y,{value:O(s.memoryUsed||0,s.memoryTotal),color:O(s.memoryUsed||0,s.memoryTotal)>90?"red":"blue",size:"lg"}),e.jsxs(l,{size:"xs",c:"dimmed",children:[F(s.memoryUsed||0)," / ",F(s.memoryTotal)," (",O(s.memoryUsed||0,s.memoryTotal),"%)"]})]})})}),(s==null?void 0:s.diskTotal)&&e.jsx(L.Col,{span:{base:12,md:6},children:e.jsx(R,{shadow:"sm",padding:"lg",children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:"Disk Usage"}),e.jsx(Y,{value:O(s.diskUsed||0,s.diskTotal),color:O(s.diskUsed||0,s.diskTotal)>90?"red":"blue",size:"lg"}),e.jsxs(l,{size:"xs",c:"dimmed",children:[F(s.diskUsed||0)," / ",F(s.diskTotal)," (",O(s.diskUsed||0,s.diskTotal),"%)"]})]})})})]}),e.jsx(R,{shadow:"sm",padding:"lg",children:e.jsxs(E,{value:u,onChange:f,children:[e.jsxs(E.List,{children:[e.jsx(E.Tab,{value:"overview",children:"Overview"}),e.jsxs(E.Tab,{value:"nodes",children:["Nodes (",(m==null?void 0:m.length)||0,")"]}),e.jsxs(E.Tab,{value:"indices",children:["Indices (",(j==null?void 0:j.length)||0,")"]}),e.jsxs(E.Tab,{value:"shards",children:["Shards (",(c==null?void 0:c.length)||0,")"]})]}),e.jsx(E.Panel,{value:"overview",pt:"md",children:e.jsx(Is,{nodes:m,indices:j,shards:c,loading:x||r||y,error:g||o||a})}),e.jsx(E.Panel,{value:"nodes",pt:"md",children:e.jsx(Ts,{nodes:m,loading:x,error:g})}),e.jsx(E.Panel,{value:"indices",pt:"md",children:e.jsx(ks,{indices:j,loading:r,error:o})}),e.jsx(E.Panel,{value:"shards",pt:"md",children:e.jsx(zs,{shards:c,loading:y,error:a})})]})})]}):e.jsx(k,{p:"md",children:e.jsx(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:"Cluster ID is required"})})}function Ts({nodes:t,loading:n,error:d}){var j;const{id:h}=ae(),u=ue(),[f,p]=te(),s=f.get("nodesSearch")||"",C=((j=f.get("roles"))==null?void 0:j.split(",").filter(Boolean))||[],v=le(s,300),m=(r,o)=>{const c=new URLSearchParams(f);r!==void 0&&(r?c.set("nodesSearch",r):c.delete("nodesSearch")),o!==void 0&&(o.length>0?c.set("roles",o.join(",")):c.delete("roles")),p(c)},x=Array.from(new Set((t==null?void 0:t.flatMap(r=>r.roles))||[])),g=t==null?void 0:t.filter(r=>{var y;const o=r.name.toLowerCase().includes(v.toLowerCase())||((y=r.ip)==null?void 0:y.toLowerCase().includes(v.toLowerCase())),c=C.length===0||C.some(a=>r.roles.includes(a));return o&&c});return n?e.jsx(I,{justify:"center",py:"xl",children:e.jsx(Q,{})}):d?e.jsxs(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:["Failed to load nodes: ",d.message]}):!t||t.length===0?e.jsx(l,{c:"dimmed",children:"No nodes found"}):e.jsxs(k,{gap:"md",children:[e.jsxs(I,{children:[e.jsx(K,{placeholder:"Search nodes...",leftSection:e.jsx(oe,{size:16}),value:s,onChange:r=>m(r.currentTarget.value,void 0),style:{flex:1,maxWidth:400}}),e.jsx(ee,{placeholder:"Filter by roles",data:x,value:C,onChange:r=>m(void 0,r),clearable:!0,searchable:!0,style:{flex:1,maxWidth:300}})]}),g&&g.length===0?e.jsx(l,{c:"dimmed",ta:"center",py:"xl",children:"No nodes match your filters"}):e.jsx(ie,{children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Name"}),e.jsx(i.Th,{children:"Roles"}),e.jsx(i.Th,{children:"Heap Usage"}),e.jsx(i.Th,{children:"Disk Usage"}),e.jsx(i.Th,{children:"CPU"})]})}),e.jsx(i.Tbody,{children:g==null?void 0:g.map(r=>e.jsxs(i.Tr,{style:{cursor:"pointer"},onClick:()=>u(`/cluster/${h}/nodes/${r.id}`),children:[e.jsxs(i.Td,{children:[e.jsx(l,{size:"sm",fw:500,children:r.name}),r.ip&&e.jsx(l,{size:"xs",c:"dimmed",children:r.ip})]}),e.jsx(i.Td,{children:e.jsx(I,{gap:"xs",children:r.roles.map(o=>e.jsx(U,{size:"sm",variant:"light",children:o},o))})}),e.jsx(i.Td,{children:e.jsxs(k,{gap:4,children:[e.jsx(Y,{value:O(r.heapUsed,r.heapMax),color:O(r.heapUsed,r.heapMax)>90?"red":"blue",size:"sm"}),e.jsxs(l,{size:"xs",c:"dimmed",children:[F(r.heapUsed)," / ",F(r.heapMax)]})]})}),e.jsx(i.Td,{children:e.jsxs(k,{gap:4,children:[e.jsx(Y,{value:O(r.diskUsed,r.diskTotal),color:O(r.diskUsed,r.diskTotal)>90?"red":"blue",size:"sm"}),e.jsxs(l,{size:"xs",c:"dimmed",children:[F(r.diskUsed)," / ",F(r.diskTotal)]})]})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:r.cpuPercent!==void 0?`${r.cpuPercent}%`:"N/A"})})]},r.id))})]})})]})}function ks({indices:t,loading:n,error:d}){var j,r;const{id:h}=ae(),u=ue(),[f,p]=te(),s=f.get("indicesSearch")||"",C=((j=f.get("health"))==null?void 0:j.split(",").filter(Boolean))||[],v=((r=f.get("status"))==null?void 0:r.split(",").filter(Boolean))||[],m=le(s,300),x=(o,c,y)=>{const a=new URLSearchParams(f);o!==void 0&&(o?a.set("indicesSearch",o):a.delete("indicesSearch")),c!==void 0&&(c.length>0?a.set("health",c.join(",")):a.delete("health")),y!==void 0&&(y.length>0?a.set("status",y.join(",")):a.delete("status")),p(a)},g=t==null?void 0:t.filter(o=>{const c=o.name.toLowerCase().includes(m.toLowerCase()),y=C.length===0||C.includes(o.health),a=v.length===0||v.includes(o.status);return c&&y&&a});return n?e.jsx(I,{justify:"center",py:"xl",children:e.jsx(Q,{})}):d?e.jsxs(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:["Failed to load indices: ",d.message]}):!t||t.length===0?e.jsxs(k,{gap:"md",align:"center",py:"xl",children:[e.jsx(l,{c:"dimmed",children:"No indices found"}),h&&e.jsx(W,{leftSection:e.jsx(Te,{size:16}),onClick:()=>u(`/cluster/${h}/indices/create`),children:"Create Index"})]}):e.jsxs(k,{gap:"md",children:[e.jsxs(I,{justify:"space-between",wrap:"wrap",children:[e.jsxs(I,{style:{flex:1},children:[e.jsx(K,{placeholder:"Search indices...",leftSection:e.jsx(oe,{size:16}),value:s,onChange:o=>x(o.currentTarget.value,void 0,void 0),style:{flex:1,maxWidth:300}}),e.jsx(ee,{placeholder:"Health",data:["green","yellow","red"],value:C,onChange:o=>x(void 0,o,void 0),clearable:!0,style:{maxWidth:200}}),e.jsx(ee,{placeholder:"Status",data:["open","close"],value:v,onChange:o=>x(void 0,void 0,o),clearable:!0,style:{maxWidth:150}})]}),h&&e.jsx(W,{leftSection:e.jsx(Te,{size:16}),onClick:()=>u(`/cluster/${h}/indices/create`),children:"Create Index"})]}),g&&g.length===0?e.jsx(l,{c:"dimmed",ta:"center",py:"xl",children:"No indices match your filters"}):e.jsx(ie,{children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Name"}),e.jsx(i.Th,{children:"Health"}),e.jsx(i.Th,{children:"Status"}),e.jsx(i.Th,{children:"Documents"}),e.jsx(i.Th,{children:"Size"}),e.jsx(i.Th,{children:"Shards"}),e.jsx(i.Th,{children:"Actions"})]})}),e.jsx(i.Tbody,{children:g==null?void 0:g.map(o=>e.jsxs(i.Tr,{style:{cursor:"pointer"},onClick:()=>u(`/cluster/${h}/indices/${encodeURIComponent(o.name)}/settings`),children:[e.jsx(i.Td,{children:e.jsx(l,{size:"sm",fw:500,style:{textDecoration:"underline"},children:o.name})}),e.jsx(i.Td,{children:e.jsx(U,{size:"sm",color:je(o.health),children:o.health})}),e.jsx(i.Td,{children:e.jsx(U,{size:"sm",variant:"light",color:o.status==="open"?"green":"gray",children:o.status})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:o.docsCount.toLocaleString()})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:F(o.storeSize)})}),e.jsx(i.Td,{children:e.jsxs(l,{size:"sm",children:[o.primaryShards,"p / ",o.replicaShards,"r"]})}),e.jsx(i.Td,{onClick:c=>c.stopPropagation(),children:e.jsxs(I,{gap:"xs",children:[h&&e.jsx(Ss,{clusterId:h,index:o}),e.jsxs(M,{shadow:"md",width:200,children:[e.jsx(M.Target,{children:e.jsx(Me,{variant:"subtle",color:"gray",children:e.jsx(Ue,{size:16})})}),e.jsxs(M.Dropdown,{children:[e.jsx(M.Label,{children:"Index Management"}),e.jsx(M.Item,{leftSection:e.jsx(es,{size:14}),onClick:c=>{c.stopPropagation(),u(`/cluster/${h}/indices/${encodeURIComponent(o.name)}/settings`)},children:"Settings"}),e.jsx(M.Item,{leftSection:e.jsx(ss,{size:14}),onClick:c=>{c.stopPropagation(),u(`/cluster/${h}/indices/${encodeURIComponent(o.name)}/mappings`)},children:"Mappings"})]})]})]})})]},o.name))})]})})]})}function Is({nodes:t,indices:n,shards:d,loading:h,error:u}){const{id:f}=ae(),p=ue(),[s,C]=N.useState(""),[v,m]=N.useState(!1),[x,g]=N.useState(!1),j=le(s,300);if(h)return e.jsx(I,{justify:"center",py:"xl",children:e.jsx(Q,{})});if(u)return e.jsxs(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:["Failed to load shard allocation data: ",u.message]});if(!t||!n||!d||t.length===0||n.length===0)return e.jsx(k,{gap:"md",align:"center",py:"xl",children:e.jsx(l,{c:"dimmed",children:"No shard allocation data available"})});const r=n.filter(a=>{const b=a.name.toLowerCase().includes(j.toLowerCase()),S=v||a.status==="open",z=x||!a.name.startsWith(".");return b&&S&&z}),o=new Map;t.forEach(a=>{o.set(a.id,a.name),o.set(a.name,a.name),a.ip&&o.set(a.ip,a.name)});const c=new Map;d.forEach(a=>{if(!a.node)return;const b=o.get(a.node);if(!b)return;c.has(b)||c.set(b,new Map);const S=c.get(b);S.has(a.index)||S.set(a.index,[]),S.get(a.index).push(a)});const y=d.filter(a=>a.state==="UNASSIGNED");return e.jsxs(k,{gap:"md",children:[e.jsxs(I,{justify:"space-between",wrap:"wrap",children:[e.jsx(K,{placeholder:"Filter indices by name or alias...",leftSection:e.jsx(oe,{size:16}),value:s,onChange:a=>C(a.currentTarget.value),style:{flex:1,maxWidth:400}}),e.jsxs(I,{gap:"md",children:[e.jsxs(I,{gap:"xs",children:[e.jsx("input",{type:"checkbox",id:"show-closed",checked:v,onChange:a=>m(a.target.checked)}),e.jsxs(l,{size:"sm",component:"label",htmlFor:"show-closed",style:{cursor:"pointer"},children:["closed (",n.filter(a=>a.status!=="open").length,")"]})]}),e.jsxs(I,{gap:"xs",children:[e.jsx("input",{type:"checkbox",id:"show-special",checked:x,onChange:a=>g(a.target.checked)}),e.jsxs(l,{size:"sm",component:"label",htmlFor:"show-special",style:{cursor:"pointer"},children:["special (",n.filter(a=>a.name.startsWith(".")).length,")"]})]}),e.jsxs(l,{size:"sm",c:"dimmed",children:[r.length," of ",n.length]})]})]}),e.jsxs(I,{gap:"md",children:[e.jsxs(l,{size:"sm",children:[e.jsx(l,{component:"span",fw:700,children:t.length})," nodes"]}),e.jsxs(l,{size:"sm",children:[e.jsx(l,{component:"span",fw:700,children:r.length})," indices"]}),e.jsxs(l,{size:"sm",children:[e.jsx(l,{component:"span",fw:700,children:d.length})," shards"]}),y.length>0&&e.jsxs(U,{color:"red",variant:"filled",children:[y.length," unassigned"]})]}),e.jsx(ie,{children:e.jsx("div",{style:{minWidth:"800px"},children:e.jsxs(i,{striped:!0,withTableBorder:!0,withColumnBorders:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{style:{width:"120px",minWidth:"120px",maxWidth:"120px",position:"sticky",left:0,backgroundColor:"var(--mantine-color-body)",zIndex:1},children:"Node"}),r.map(a=>e.jsx(i.Th,{style:{minWidth:"120px",textAlign:"center"},children:e.jsxs(k,{gap:4,children:[e.jsx(l,{size:"xs",fw:500,truncate:"end",title:a.name,style:{cursor:"pointer",textDecoration:"underline"},onClick:b=>{b.stopPropagation(),p(`/cluster/${f}/indices/${encodeURIComponent(a.name)}/settings`)},children:a.name}),e.jsxs(I,{gap:4,justify:"center",children:[e.jsxs(U,{size:"xs",color:je(a.health),variant:"dot",children:[a.primaryShards,"Ã—",a.replicaShards+1]}),e.jsx(l,{size:"xs",c:"dimmed",children:F(a.storeSize)})]})]})},a.name))]})}),e.jsx(i.Tbody,{children:t.map(a=>{const b=c.get(a.name);return e.jsxs(i.Tr,{children:[e.jsx(i.Td,{style:{width:"120px",minWidth:"120px",maxWidth:"120px",position:"sticky",left:0,backgroundColor:"var(--mantine-color-body)",zIndex:1},children:e.jsxs(k,{gap:2,children:[e.jsx(l,{size:"xs",fw:500,truncate:"end",title:a.name,children:a.name}),e.jsx(l,{size:"xs",c:"dimmed",truncate:"end",title:a.ip,children:a.ip})]})}),r.map(S=>{const z=(b==null?void 0:b.get(S.name))||[];return e.jsx(i.Td,{style:{padding:"4px",textAlign:"center"},children:z.length>0?e.jsx(I,{gap:2,justify:"center",wrap:"wrap",children:z.map(($,D)=>e.jsx("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:$.state==="STARTED"?$.primary?"var(--mantine-color-green-6)":"var(--mantine-color-green-7)":$.state==="RELOCATING"?"var(--mantine-color-yellow-6)":"var(--mantine-color-red-6)",color:"white",fontSize:"10px",fontWeight:600,borderRadius:"2px",border:$.primary?"2px solid var(--mantine-color-green-9)":"2px dashed var(--mantine-color-green-9)"},title:`Shard ${$.shard} (${$.primary?"Primary":"Replica"}) - ${$.state}`,children:$.shard},`${$.shard}-${$.primary}-${D}`))}):e.jsx(l,{size:"xs",c:"dimmed",children:"-"})},`${a.id}-${S.name}`)})]},a.id)})})]})})})]})}function zs({shards:t,loading:n,error:d}){var j;const[h,u]=te(),f=h.get("shardsSearch")||"",p=((j=h.get("shardStates"))==null?void 0:j.split(",").filter(Boolean))||[],s=h.get("primaryOnly")==="true",C=h.get("replicaOnly")==="true",v=le(f,300),m=(r,o,c,y)=>{const a=new URLSearchParams(h);r!==void 0&&(r?a.set("shardsSearch",r):a.delete("shardsSearch")),o!==void 0&&(o.length>0?a.set("shardStates",o.join(",")):a.delete("shardStates")),c!==void 0&&(c?(a.set("primaryOnly","true"),a.delete("replicaOnly")):a.delete("primaryOnly")),y!==void 0&&(y?(a.set("replicaOnly","true"),a.delete("primaryOnly")):a.delete("replicaOnly")),u(a)},x=t==null?void 0:t.filter(r=>{var a;const o=r.index.toLowerCase().includes(v.toLowerCase())||((a=r.node)==null?void 0:a.toLowerCase().includes(v.toLowerCase())),c=p.length===0||p.includes(r.state),y=!s&&!C||s&&r.primary||C&&!r.primary;return o&&c&&y});if(n)return e.jsx(I,{justify:"center",py:"xl",children:e.jsx(Q,{})});if(d)return e.jsxs(q,{icon:e.jsx(V,{size:16}),title:"Error",color:"red",children:["Failed to load shards: ",d.message]});if(!t||t.length===0)return e.jsx(l,{c:"dimmed",children:"No shards found"});const g=(x||[]).reduce((r,o)=>(r[o.state]||(r[o.state]=[]),r[o.state].push(o),r),{});return e.jsxs(k,{gap:"md",children:[e.jsxs(I,{wrap:"wrap",children:[e.jsx(K,{placeholder:"Search by index or node...",leftSection:e.jsx(oe,{size:16}),value:f,onChange:r=>m(r.currentTarget.value,void 0,void 0,void 0),style:{flex:1,maxWidth:300}}),e.jsx(ee,{placeholder:"State",data:["STARTED","INITIALIZING","RELOCATING","UNASSIGNED"],value:p,onChange:r=>m(void 0,r,void 0,void 0),clearable:!0,style:{maxWidth:250}}),e.jsxs(I,{gap:"md",children:[e.jsx(B,{label:"Primary only",checked:s,onChange:r=>m(void 0,void 0,r.currentTarget.checked,void 0)}),e.jsx(B,{label:"Replica only",checked:C,onChange:r=>m(void 0,void 0,void 0,r.currentTarget.checked)})]})]}),e.jsx(L,{children:Object.entries(g).map(([r,o])=>e.jsx(L.Col,{span:{base:12,sm:6,md:3},children:e.jsx(R,{shadow:"sm",padding:"md",children:e.jsxs(k,{gap:"xs",children:[e.jsx(l,{size:"sm",c:"dimmed",children:r}),e.jsx(l,{size:"xl",fw:700,children:o.length})]})})},r))}),x&&x.length===0?e.jsx(l,{c:"dimmed",ta:"center",py:"xl",children:"No shards match your filters"}):e.jsxs(ie,{children:[e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Index"}),e.jsx(i.Th,{children:"Shard"}),e.jsx(i.Th,{children:"Type"}),e.jsx(i.Th,{children:"State"}),e.jsx(i.Th,{children:"Node"}),e.jsx(i.Th,{children:"Documents"}),e.jsx(i.Th,{children:"Size"})]})}),e.jsx(i.Tbody,{children:x==null?void 0:x.slice(0,100).map((r,o)=>{var c;return e.jsxs(i.Tr,{children:[e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:r.index})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:r.shard})}),e.jsx(i.Td,{children:e.jsx(U,{size:"sm",variant:"light",color:r.primary?"blue":"gray",children:r.primary?"Primary":"Replica"})}),e.jsx(i.Td,{children:e.jsx(U,{size:"sm",color:r.state==="STARTED"?"green":r.state==="UNASSIGNED"?"red":"yellow",children:r.state})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:r.node||"N/A"})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:((c=r.docs)==null?void 0:c.toLocaleString())||"N/A"})}),e.jsx(i.Td,{children:e.jsx(l,{size:"sm",children:r.store?F(r.store):"N/A"})})]},`${r.index}-${r.shard}-${o}`)})})]}),x&&x.length>100&&e.jsxs(l,{size:"sm",c:"dimmed",ta:"center",mt:"md",children:["Showing first 100 of ",x.length," shards"]})]})]})}export{Hs as ClusterView};
