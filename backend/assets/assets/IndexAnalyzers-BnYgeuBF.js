import{c as B,k as G,r as F,a as C,j as e,G as d,L as J,T as K,b as j,S as A,l as R,d as i,al as m,e as S}from"./index-Buu7g-RE.js";import{C as v}from"./Container-DfjI1Ua2.js";import{A as g,I as u}from"./IconAlertCircle-B0XxZZ5J.js";import{T as c}from"./Tabs-BtBGCviM.js";import{B as l}from"./Badge-YfQkYhC0.js";import{C as p}from"./Card-US0WKih7.js";import{T as H}from"./TextInput-DmPUUrU_.js";import{S as M}from"./Select-ZHOnCWZB.js";import{A as t}from"./Accordion-BtjwgrxH.js";import"./get-safe-id-Bp3H8K0-.js";import"./get-auto-contrast-value-Da6zqqWm.js";import"./InputBase-N3lF722j.js";import"./OptionsDropdown-C02DhgFU.js";var Q=B("filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);function le(){const{id:h,indexName:o}=G(),[f,I]=F.useState(""),[b,w]=F.useState(""),{data:s,isLoading:O,error:L}=C({queryKey:["cluster",h,"index",o,"analyzers"],queryFn:()=>S.getIndexAnalyzers(h,o),enabled:!!h&&!!o}),{data:a,isLoading:P,error:N}=C({queryKey:["cluster",h,"index",o,"fields"],queryFn:()=>S.getIndexFields(h,o),enabled:!!h&&!!o});if(!h||!o)return e.jsx(v,{size:"xl",children:e.jsx(g,{icon:e.jsx(u,{size:16}),title:"Error",color:"red",children:"Cluster ID and index name are required"})});const E=O||P,T=L||N;if(E)return e.jsx(v,{size:"xl",children:e.jsx(d,{justify:"center",mt:"xl",children:e.jsx(J,{size:"lg"})})});if(T)return e.jsx(v,{size:"xl",children:e.jsxs(g,{icon:e.jsx(u,{size:16}),title:"Error",color:"red",children:["Failed to load index analyzers: ",T.message]})});const k=(a==null?void 0:a.fields.filter(r=>{const x=!f||r.name.toLowerCase().includes(f.toLowerCase()),n=!b||r.type===b;return x&&n}))||[],q=Array.from(new Set((a==null?void 0:a.fields.map(r=>r.type))||[])).sort();return e.jsxs(v,{size:"xl",py:"md",children:[e.jsx(d,{justify:"space-between",mb:"md",children:e.jsxs("div",{children:[e.jsx(K,{order:2,children:"Index Analyzers & Fields"}),e.jsx(j,{size:"sm",c:"dimmed",children:o})]})}),e.jsxs(c,{defaultValue:"fields",children:[e.jsxs(c.List,{children:[e.jsx(c.Tab,{value:"fields",children:e.jsxs(d,{gap:"xs",children:["Fields",e.jsx(l,{size:"sm",variant:"light",children:(a==null?void 0:a.fields.length)||0})]})}),e.jsx(c.Tab,{value:"analyzers",children:e.jsxs(d,{gap:"xs",children:["Analyzers",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.analyzers)||{}).length})]})}),e.jsx(c.Tab,{value:"tokenizers",children:e.jsxs(d,{gap:"xs",children:["Tokenizers",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.tokenizers)||{}).length})]})}),e.jsx(c.Tab,{value:"filters",children:e.jsxs(d,{gap:"xs",children:["Filters",e.jsx(l,{size:"sm",variant:"light",children:Object.keys((s==null?void 0:s.filters)||{}).length})]})})]}),e.jsx(c.Panel,{value:"fields",pt:"md",children:e.jsxs(A,{gap:"md",children:[e.jsx(p,{shadow:"sm",padding:"md",children:e.jsxs(d,{grow:!0,children:[e.jsx(H,{placeholder:"Filter by field name...",leftSection:e.jsx(R,{size:16}),value:f,onChange:r=>I(r.currentTarget.value)}),e.jsx(M,{placeholder:"Filter by type...",leftSection:e.jsx(Q,{size:16}),value:b,onChange:r=>w(r||""),data:[{value:"",label:"All types"},...q.map(r=>({value:r,label:r}))],clearable:!0})]})}),e.jsx(p,{shadow:"sm",padding:"lg",children:e.jsxs(i,{striped:!0,highlightOnHover:!0,children:[e.jsx(i.Thead,{children:e.jsxs(i.Tr,{children:[e.jsx(i.Th,{children:"Field Name"}),e.jsx(i.Th,{children:"Type"}),e.jsx(i.Th,{children:"Analyzer"}),e.jsx(i.Th,{children:"Search Analyzer"}),e.jsx(i.Th,{children:"Properties"})]})}),e.jsx(i.Tbody,{children:k.length===0?e.jsx(i.Tr,{children:e.jsx(i.Td,{colSpan:5,children:e.jsx(j,{ta:"center",c:"dimmed",children:"No fields found"})})}):k.map(r=>e.jsxs(i.Tr,{children:[e.jsx(i.Td,{children:e.jsx(m,{children:r.name})}),e.jsx(i.Td,{children:e.jsx(l,{variant:"light",color:"blue",children:r.type})}),e.jsx(i.Td,{children:r.analyzer?e.jsx(l,{variant:"light",color:"green",children:r.analyzer}):e.jsx(j,{size:"sm",c:"dimmed",children:"default"})}),e.jsx(i.Td,{children:r.searchAnalyzer?e.jsx(l,{variant:"light",color:"orange",children:r.searchAnalyzer}):e.jsx(j,{size:"sm",c:"dimmed",children:"-"})}),e.jsx(i.Td,{children:e.jsxs(d,{gap:"xs",children:[r.searchable&&e.jsx(l,{size:"xs",variant:"light",color:"blue",children:"Searchable"}),r.aggregatable&&e.jsx(l,{size:"xs",variant:"light",color:"green",children:"Aggregatable"}),r.stored&&e.jsx(l,{size:"xs",variant:"light",color:"orange",children:"Stored"})]})})]},r.name))})]})})]})}),e.jsx(c.Panel,{value:"analyzers",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.analyzers)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom analyzers configured for this index. The index uses built-in Elasticsearch analyzers."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.analyzers)||{}).map(([r,x])=>{const n=x;return e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsxs(d,{justify:"space-between",children:[e.jsx(m,{children:r}),n.type&&e.jsx(l,{variant:"light",color:"blue",children:n.type})]})}),e.jsx(t.Panel,{children:e.jsxs(A,{gap:"sm",children:[n.tokenizer&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Tokenizer:"}),e.jsx(l,{variant:"light",color:"green",children:n.tokenizer})]}),n.charFilter&&n.charFilter.length>0&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Character Filters:"}),e.jsx(d,{gap:"xs",children:n.charFilter.map((z,y)=>e.jsx(l,{variant:"light",color:"orange",children:z},y))})]}),n.filter&&n.filter.length>0&&e.jsxs("div",{children:[e.jsx(j,{size:"sm",fw:500,mb:"xs",children:"Token Filters:"}),e.jsx(d,{gap:"xs",children:n.filter.map((z,y)=>e.jsx(l,{variant:"light",color:"purple",children:z},y))})]})]})})]},r)})})})}),e.jsx(c.Panel,{value:"tokenizers",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.tokenizers)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom tokenizers configured for this index."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.tokenizers)||{}).map(([r,x])=>e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsx(m,{children:r})}),e.jsx(t.Panel,{children:e.jsx(m,{block:!0,children:JSON.stringify(x,null,2)})})]},r))})})}),e.jsx(c.Panel,{value:"filters",pt:"md",children:e.jsx(p,{shadow:"sm",padding:"lg",children:Object.keys((s==null?void 0:s.filters)||{}).length===0?e.jsx(g,{icon:e.jsx(u,{size:16}),color:"blue",variant:"light",children:"No custom token filters configured for this index."}):e.jsx(t,{variant:"contained",children:Object.entries((s==null?void 0:s.filters)||{}).map(([r,x])=>e.jsxs(t.Item,{value:r,children:[e.jsx(t.Control,{children:e.jsx(m,{children:r})}),e.jsx(t.Panel,{children:e.jsx(m,{block:!0,children:JSON.stringify(x,null,2)})})]},r))})})})]})]})}export{le as IndexAnalyzersPage};
